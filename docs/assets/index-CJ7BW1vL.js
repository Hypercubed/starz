(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const nn=BigInt(2**32-1),kr=BigInt(32);function Sl(e,t=!1){return t?{h:Number(e&nn),l:Number(e>>kr&nn)}:{h:Number(e>>kr&nn)|0,l:Number(e&nn)|0}}function Ml(e,t=!1){const n=e.length;let i=new Uint32Array(n),r=new Uint32Array(n);for(let o=0;o<n;o++){const{h:s,l}=Sl(e[o],t);[i[o],r[o]]=[s,l]}return[i,r]}const El=(e,t,n)=>e<<n|t>>>32-n,Il=(e,t,n)=>t<<n|e>>>32-n,Al=(e,t,n)=>t<<n-32|e>>>64-n,bl=(e,t,n)=>e<<n-32|t>>>64-n;function Nl(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Pr(e,t=""){if(!Number.isSafeInteger(e)||e<0){const n=t&&`"${t}" `;throw new Error(`${n}expected integer >= 0, got ${e}`)}}function Ei(e,t,n=""){const i=Nl(e),r=e?.length;if(!i||t!==void 0){const s=n&&`"${n}" `,l="",a=i?`length=${r}`:`type=${typeof e}`;throw new Error(s+"expected Uint8Array"+l+", got "+a)}return e}function Lr(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function $l(e,t){Ei(e,void 0,"digestInto() output");const n=t.outputLen;if(e.length<n)throw new Error('"digestInto() output" expected to be of length >='+n)}function Tl(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Yo(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}const kl=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Pl(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function Ll(e){for(let t=0;t<e.length;t++)e[t]=Pl(e[t]);return e}const Or=kl?e=>e:Ll;function Ol(e,t={}){const n=(r,o)=>e(o).update(r).digest(),i=e(void 0);return n.outputLen=i.outputLen,n.blockLen=i.blockLen,n.create=r=>e(r),Object.assign(n,t),Object.freeze(n)}const Dl=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])}),Rl=BigInt(0),Ae=BigInt(1),Cl=BigInt(2),Bl=BigInt(7),zl=BigInt(256),Fl=BigInt(113),Ko=[],Vo=[],jo=[];for(let e=0,t=Ae,n=1,i=0;e<24;e++){[n,i]=[i,(2*n+3*i)%5],Ko.push(2*(5*i+n)),Vo.push((e+1)*(e+2)/2%64);let r=Rl;for(let o=0;o<7;o++)t=(t<<Ae^(t>>Bl)*Fl)%zl,t&Cl&&(r^=Ae<<(Ae<<BigInt(o))-Ae);jo.push(r)}const Wo=Ml(jo,!0),Gl=Wo[0],Hl=Wo[1],Dr=(e,t,n)=>n>32?Al(e,t,n):El(e,t,n),Rr=(e,t,n)=>n>32?bl(e,t,n):Il(e,t,n);function ql(e,t=24){const n=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let s=0;s<10;s++)n[s]=e[s]^e[s+10]^e[s+20]^e[s+30]^e[s+40];for(let s=0;s<10;s+=2){const l=(s+8)%10,a=(s+2)%10,u=n[a],c=n[a+1],f=Dr(u,c,1)^n[l],d=Rr(u,c,1)^n[l+1];for(let w=0;w<50;w+=10)e[s+w]^=f,e[s+w+1]^=d}let r=e[2],o=e[3];for(let s=0;s<24;s++){const l=Vo[s],a=Dr(r,o,l),u=Rr(r,o,l),c=Ko[s];r=e[c],o=e[c+1],e[c]=a,e[c+1]=u}for(let s=0;s<50;s+=10){for(let l=0;l<10;l++)n[l]=e[s+l];for(let l=0;l<10;l++)e[s+l]^=~n[(l+2)%10]&n[(l+4)%10]}e[0]^=Gl[i],e[1]^=Hl[i]}Yo(n)}class ur{state;pos=0;posOut=0;finished=!1;state32;destroyed=!1;blockLen;suffix;outputLen;enableXOF=!1;rounds;constructor(t,n,i,r=!1,o=24){if(this.blockLen=t,this.suffix=n,this.outputLen=i,this.enableXOF=r,this.rounds=o,Pr(i,"outputLen"),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Tl(this.state)}clone(){return this._cloneInto()}keccak(){Or(this.state32),ql(this.state32,this.rounds),Or(this.state32),this.posOut=0,this.pos=0}update(t){Lr(this),Ei(t);const{blockLen:n,state:i}=this,r=t.length;for(let o=0;o<r;){const s=Math.min(n-this.pos,r-o);for(let l=0;l<s;l++)i[this.pos++]^=t[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:i,blockLen:r}=this;t[i]^=n,(n&128)!==0&&i===r-1&&this.keccak(),t[r-1]^=128,this.keccak()}writeInto(t){Lr(this,!1),Ei(t),this.finish();const n=this.state,{blockLen:i}=this;for(let r=0,o=t.length;r<o;){this.posOut>=i&&this.keccak();const s=Math.min(i-this.posOut,o-r);t.set(n.subarray(this.posOut,this.posOut+s),r),this.posOut+=s,r+=s}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Pr(t),this.xofInto(new Uint8Array(t))}digestInto(t){if($l(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Yo(this.state)}_cloneInto(t){const{blockLen:n,suffix:i,outputLen:r,rounds:o,enableXOF:s}=this;return t||=new ur(n,i,r,s,o),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=o,t.suffix=i,t.outputLen=r,t.enableXOF=s,t.destroyed=this.destroyed,t}}const Ul=(e,t,n,i={})=>Ol(()=>new ur(t,e,n),i),Xl=Ul(6,72,64,Dl(10));var Yl=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,ai=Math.ceil,St=Math.floor,pt="[BigNumber Error] ",Cr=pt+"Number primitive has more than 15 significant digits: ",At=1e14,H=14,ui=9007199254740991,ci=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],jt=1e7,rt=1e9;function Qo(e){var t,n,i,r=A.prototype={constructor:A,toString:null,valueOf:null},o=new A(1),s=20,l=4,a=-7,u=21,c=-1e7,f=1e7,d=!1,w=1,S=0,b={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},P="0123456789abcdefghijklmnopqrstuvwxyz",N=!0;function A(h,p){var v,_,M,I,y,g,m,x,E=this;if(!(E instanceof A))return new A(h,p);if(p==null){if(h&&h._isBigNumber===!0){E.s=h.s,!h.c||h.e>f?E.c=E.e=null:h.e<c?E.c=[E.e=0]:(E.e=h.e,E.c=h.c.slice());return}if((g=typeof h=="number")&&h*0==0){if(E.s=1/h<0?(h=-h,-1):1,h===~~h){for(I=0,y=h;y>=10;y/=10,I++);I>f?E.c=E.e=null:(E.e=I,E.c=[h]);return}x=String(h)}else{if(!Yl.test(x=String(h)))return i(E,x,g);E.s=x.charCodeAt(0)==45?(x=x.slice(1),-1):1}(I=x.indexOf("."))>-1&&(x=x.replace(".","")),(y=x.search(/e/i))>0?(I<0&&(I=y),I+=+x.slice(y+1),x=x.substring(0,y)):I<0&&(I=x.length)}else{if(J(p,2,P.length,"Base"),p==10&&N)return E=new A(h),D(E,s+E.e+1,l);if(x=String(h),g=typeof h=="number"){if(h*0!=0)return i(E,x,g,p);if(E.s=1/h<0?(x=x.slice(1),-1):1,A.DEBUG&&x.replace(/^0\.0*|\./,"").length>15)throw Error(Cr+h)}else E.s=x.charCodeAt(0)===45?(x=x.slice(1),-1):1;for(v=P.slice(0,p),I=y=0,m=x.length;y<m;y++)if(v.indexOf(_=x.charAt(y))<0){if(_=="."){if(y>I){I=m;continue}}else if(!M&&(x==x.toUpperCase()&&(x=x.toLowerCase())||x==x.toLowerCase()&&(x=x.toUpperCase()))){M=!0,y=-1,I=0;continue}return i(E,String(h),g,p)}g=!1,x=n(x,p,10,E.s),(I=x.indexOf("."))>-1?x=x.replace(".",""):I=x.length}for(y=0;x.charCodeAt(y)===48;y++);for(m=x.length;x.charCodeAt(--m)===48;);if(x=x.slice(y,++m)){if(m-=y,g&&A.DEBUG&&m>15&&(h>ui||h!==St(h)))throw Error(Cr+E.s*h);if((I=I-y-1)>f)E.c=E.e=null;else if(I<c)E.c=[E.e=0];else{if(E.e=I,E.c=[],y=(I+1)%H,I<0&&(y+=H),y<m){for(y&&E.c.push(+x.slice(0,y)),m-=H;y<m;)E.c.push(+x.slice(y,y+=H));y=H-(x=x.slice(y)).length}else y-=m;for(;y--;x+="0");E.c.push(+x)}}else E.c=[E.e=0]}A.clone=Qo,A.ROUND_UP=0,A.ROUND_DOWN=1,A.ROUND_CEIL=2,A.ROUND_FLOOR=3,A.ROUND_HALF_UP=4,A.ROUND_HALF_DOWN=5,A.ROUND_HALF_EVEN=6,A.ROUND_HALF_CEIL=7,A.ROUND_HALF_FLOOR=8,A.EUCLID=9,A.config=A.set=function(h){var p,v;if(h!=null)if(typeof h=="object"){if(h.hasOwnProperty(p="DECIMAL_PLACES")&&(v=h[p],J(v,0,rt,p),s=v),h.hasOwnProperty(p="ROUNDING_MODE")&&(v=h[p],J(v,0,8,p),l=v),h.hasOwnProperty(p="EXPONENTIAL_AT")&&(v=h[p],v&&v.pop?(J(v[0],-rt,0,p),J(v[1],0,rt,p),a=v[0],u=v[1]):(J(v,-rt,rt,p),a=-(u=v<0?-v:v))),h.hasOwnProperty(p="RANGE"))if(v=h[p],v&&v.pop)J(v[0],-rt,-1,p),J(v[1],1,rt,p),c=v[0],f=v[1];else if(J(v,-rt,rt,p),v)c=-(f=v<0?-v:v);else throw Error(pt+p+" cannot be zero: "+v);if(h.hasOwnProperty(p="CRYPTO"))if(v=h[p],v===!!v)if(v)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))d=v;else throw d=!v,Error(pt+"crypto unavailable");else d=v;else throw Error(pt+p+" not true or false: "+v);if(h.hasOwnProperty(p="MODULO_MODE")&&(v=h[p],J(v,0,9,p),w=v),h.hasOwnProperty(p="POW_PRECISION")&&(v=h[p],J(v,0,rt,p),S=v),h.hasOwnProperty(p="FORMAT"))if(v=h[p],typeof v=="object")b=v;else throw Error(pt+p+" not an object: "+v);if(h.hasOwnProperty(p="ALPHABET"))if(v=h[p],typeof v=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(v))N=v.slice(0,10)=="0123456789",P=v;else throw Error(pt+p+" invalid: "+v)}else throw Error(pt+"Object expected: "+h);return{DECIMAL_PLACES:s,ROUNDING_MODE:l,EXPONENTIAL_AT:[a,u],RANGE:[c,f],CRYPTO:d,MODULO_MODE:w,POW_PRECISION:S,FORMAT:b,ALPHABET:P}},A.isBigNumber=function(h){if(!h||h._isBigNumber!==!0)return!1;if(!A.DEBUG)return!0;var p,v,_=h.c,M=h.e,I=h.s;t:if({}.toString.call(_)=="[object Array]"){if((I===1||I===-1)&&M>=-rt&&M<=rt&&M===St(M)){if(_[0]===0){if(M===0&&_.length===1)return!0;break t}if(p=(M+1)%H,p<1&&(p+=H),String(_[0]).length==p){for(p=0;p<_.length;p++)if(v=_[p],v<0||v>=At||v!==St(v))break t;if(v!==0)return!0}}}else if(_===null&&M===null&&(I===null||I===1||I===-1))return!0;throw Error(pt+"Invalid BigNumber: "+h)},A.maximum=A.max=function(){return k(arguments,-1)},A.minimum=A.min=function(){return k(arguments,1)},A.random=(function(){var h=9007199254740992,p=Math.random()*h&2097151?function(){return St(Math.random()*h)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(v){var _,M,I,y,g,m=0,x=[],E=new A(o);if(v==null?v=s:J(v,0,rt),y=ai(v/H),d)if(crypto.getRandomValues){for(_=crypto.getRandomValues(new Uint32Array(y*=2));m<y;)g=_[m]*131072+(_[m+1]>>>11),g>=9e15?(M=crypto.getRandomValues(new Uint32Array(2)),_[m]=M[0],_[m+1]=M[1]):(x.push(g%1e14),m+=2);m=y/2}else if(crypto.randomBytes){for(_=crypto.randomBytes(y*=7);m<y;)g=(_[m]&31)*281474976710656+_[m+1]*1099511627776+_[m+2]*4294967296+_[m+3]*16777216+(_[m+4]<<16)+(_[m+5]<<8)+_[m+6],g>=9e15?crypto.randomBytes(7).copy(_,m):(x.push(g%1e14),m+=7);m=y/7}else throw d=!1,Error(pt+"crypto unavailable");if(!d)for(;m<y;)g=p(),g<9e15&&(x[m++]=g%1e14);for(y=x[--m],v%=H,y&&v&&(g=ci[H-v],x[m]=St(y/g)*g);x[m]===0;x.pop(),m--);if(m<0)x=[I=0];else{for(I=-1;x[0]===0;x.splice(0,1),I-=H);for(m=1,g=x[0];g>=10;g/=10,m++);m<H&&(I-=H-m)}return E.e=I,E.c=x,E}})(),A.sum=function(){for(var h=1,p=arguments,v=new A(p[0]);h<p.length;)v=v.plus(p[h++]);return v},n=(function(){var h="0123456789";function p(v,_,M,I){for(var y,g=[0],m,x=0,E=v.length;x<E;){for(m=g.length;m--;g[m]*=_);for(g[0]+=I.indexOf(v.charAt(x++)),y=0;y<g.length;y++)g[y]>M-1&&(g[y+1]==null&&(g[y+1]=0),g[y+1]+=g[y]/M|0,g[y]%=M)}return g.reverse()}return function(v,_,M,I,y){var g,m,x,E,$,O,C,z,G=v.indexOf("."),q=s,F=l;for(G>=0&&(E=S,S=0,v=v.replace(".",""),z=new A(_),O=z.pow(v.length-G),S=E,z.c=p(Gt(xt(O.c),O.e,"0"),10,M,h),z.e=z.c.length),C=p(v,_,M,y?(g=P,h):(g=h,P)),x=E=C.length;C[--E]==0;C.pop());if(!C[0])return g.charAt(0);if(G<0?--x:(O.c=C,O.e=x,O.s=I,O=t(O,z,q,F,M),C=O.c,$=O.r,x=O.e),m=x+q+1,G=C[m],E=M/2,$=$||m<0||C[m+1]!=null,$=F<4?(G!=null||$)&&(F==0||F==(O.s<0?3:2)):G>E||G==E&&(F==4||$||F==6&&C[m-1]&1||F==(O.s<0?8:7)),m<1||!C[0])v=$?Gt(g.charAt(1),-q,g.charAt(0)):g.charAt(0);else{if(C.length=m,$)for(--M;++C[--m]>M;)C[m]=0,m||(++x,C=[1].concat(C));for(E=C.length;!C[--E];);for(G=0,v="";G<=E;v+=g.charAt(C[G++]));v=Gt(v,x,g.charAt(0))}return v}})(),t=(function(){function h(_,M,I){var y,g,m,x,E=0,$=_.length,O=M%jt,C=M/jt|0;for(_=_.slice();$--;)m=_[$]%jt,x=_[$]/jt|0,y=C*m+x*O,g=O*m+y%jt*jt+E,E=(g/I|0)+(y/jt|0)+C*x,_[$]=g%I;return E&&(_=[E].concat(_)),_}function p(_,M,I,y){var g,m;if(I!=y)m=I>y?1:-1;else for(g=m=0;g<I;g++)if(_[g]!=M[g]){m=_[g]>M[g]?1:-1;break}return m}function v(_,M,I,y){for(var g=0;I--;)_[I]-=g,g=_[I]<M[I]?1:0,_[I]=g*y+_[I]-M[I];for(;!_[0]&&_.length>1;_.splice(0,1));}return function(_,M,I,y,g){var m,x,E,$,O,C,z,G,q,F,X,W,dt,Jt,li,Pt,Ie,_t=_.s==M.s?1:-1,lt=_.c,tt=M.c;if(!lt||!lt[0]||!tt||!tt[0])return new A(!_.s||!M.s||(lt?tt&&lt[0]==tt[0]:!tt)?NaN:lt&&lt[0]==0||!tt?_t*0:_t/0);for(G=new A(_t),q=G.c=[],x=_.e-M.e,_t=I+x+1,g||(g=At,x=Mt(_.e/H)-Mt(M.e/H),_t=_t/H|0),E=0;tt[E]==(lt[E]||0);E++);if(tt[E]>(lt[E]||0)&&x--,_t<0)q.push(1),$=!0;else{for(Jt=lt.length,Pt=tt.length,E=0,_t+=2,O=St(g/(tt[0]+1)),O>1&&(tt=h(tt,O,g),lt=h(lt,O,g),Pt=tt.length,Jt=lt.length),dt=Pt,F=lt.slice(0,Pt),X=F.length;X<Pt;F[X++]=0);Ie=tt.slice(),Ie=[0].concat(Ie),li=tt[0],tt[1]>=g/2&&li++;do{if(O=0,m=p(tt,F,Pt,X),m<0){if(W=F[0],Pt!=X&&(W=W*g+(F[1]||0)),O=St(W/li),O>1)for(O>=g&&(O=g-1),C=h(tt,O,g),z=C.length,X=F.length;p(C,F,z,X)==1;)O--,v(C,Pt<z?Ie:tt,z,g),z=C.length,m=1;else O==0&&(m=O=1),C=tt.slice(),z=C.length;if(z<X&&(C=[0].concat(C)),v(F,C,X,g),X=F.length,m==-1)for(;p(tt,F,Pt,X)<1;)O++,v(F,Pt<X?Ie:tt,X,g),X=F.length}else m===0&&(O++,F=[0]);q[E++]=O,F[0]?F[X++]=lt[dt]||0:(F=[lt[dt]],X=1)}while((dt++<Jt||F[0]!=null)&&_t--);$=F[0]!=null,q[0]||q.splice(0,1)}if(g==At){for(E=1,_t=q[0];_t>=10;_t/=10,E++);D(G,I+(G.e=E+x*H-1)+1,y,$)}else G.e=x,G.r=+$;return G}})();function L(h,p,v,_){var M,I,y,g,m;if(v==null?v=l:J(v,0,8),!h.c)return h.toString();if(M=h.c[0],y=h.e,p==null)m=xt(h.c),m=_==1||_==2&&(y<=a||y>=u)?on(m,y):Gt(m,y,"0");else if(h=D(new A(h),p,v),I=h.e,m=xt(h.c),g=m.length,_==1||_==2&&(p<=I||I<=a)){for(;g<p;m+="0",g++);m=on(m,I)}else if(p-=y+(_===2&&I>y),m=Gt(m,I,"0"),I+1>g){if(--p>0)for(m+=".";p--;m+="0");}else if(p+=I-g,p>0)for(I+1==g&&(m+=".");p--;m+="0");return h.s<0&&M?"-"+m:m}function k(h,p){for(var v,_,M=1,I=new A(h[0]);M<h.length;M++)_=new A(h[M]),(!_.s||(v=te(I,_))===p||v===0&&I.s===p)&&(I=_);return I}function R(h,p,v){for(var _=1,M=p.length;!p[--M];p.pop());for(M=p[0];M>=10;M/=10,_++);return(v=_+v*H-1)>f?h.c=h.e=null:v<c?h.c=[h.e=0]:(h.e=v,h.c=p),h}i=(function(){var h=/^(-?)0([xbo])(?=\w[\w.]*$)/i,p=/^([^.]+)\.$/,v=/^\.([^.]+)$/,_=/^-?(Infinity|NaN)$/,M=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(I,y,g,m){var x,E=g?y:y.replace(M,"");if(_.test(E))I.s=isNaN(E)?null:E<0?-1:1;else{if(!g&&(E=E.replace(h,function($,O,C){return x=(C=C.toLowerCase())=="x"?16:C=="b"?2:8,!m||m==x?O:$}),m&&(x=m,E=E.replace(p,"$1").replace(v,"0.$1")),y!=E))return new A(E,x);if(A.DEBUG)throw Error(pt+"Not a"+(m?" base "+m:"")+" number: "+y);I.s=null}I.c=I.e=null}})();function D(h,p,v,_){var M,I,y,g,m,x,E,$=h.c,O=ci;if($){t:{for(M=1,g=$[0];g>=10;g/=10,M++);if(I=p-M,I<0)I+=H,y=p,m=$[x=0],E=St(m/O[M-y-1]%10);else if(x=ai((I+1)/H),x>=$.length)if(_){for(;$.length<=x;$.push(0));m=E=0,M=1,I%=H,y=I-H+1}else break t;else{for(m=g=$[x],M=1;g>=10;g/=10,M++);I%=H,y=I-H+M,E=y<0?0:St(m/O[M-y-1]%10)}if(_=_||p<0||$[x+1]!=null||(y<0?m:m%O[M-y-1]),_=v<4?(E||_)&&(v==0||v==(h.s<0?3:2)):E>5||E==5&&(v==4||_||v==6&&(I>0?y>0?m/O[M-y]:0:$[x-1])%10&1||v==(h.s<0?8:7)),p<1||!$[0])return $.length=0,_?(p-=h.e+1,$[0]=O[(H-p%H)%H],h.e=-p||0):$[0]=h.e=0,h;if(I==0?($.length=x,g=1,x--):($.length=x+1,g=O[H-I],$[x]=y>0?St(m/O[M-y]%O[y])*g:0),_)for(;;)if(x==0){for(I=1,y=$[0];y>=10;y/=10,I++);for(y=$[0]+=g,g=1;y>=10;y/=10,g++);I!=g&&(h.e++,$[0]==At&&($[0]=1));break}else{if($[x]+=g,$[x]!=At)break;$[x--]=0,g=1}for(I=$.length;$[--I]===0;$.pop());}h.e>f?h.c=h.e=null:h.e<c&&(h.c=[h.e=0])}return h}function B(h){var p,v=h.e;return v===null?h.toString():(p=xt(h.c),p=v<=a||v>=u?on(p,v):Gt(p,v,"0"),h.s<0?"-"+p:p)}return r.absoluteValue=r.abs=function(){var h=new A(this);return h.s<0&&(h.s=1),h},r.comparedTo=function(h,p){return te(this,new A(h,p))},r.decimalPlaces=r.dp=function(h,p){var v,_,M,I=this;if(h!=null)return J(h,0,rt),p==null?p=l:J(p,0,8),D(new A(I),h+I.e+1,p);if(!(v=I.c))return null;if(_=((M=v.length-1)-Mt(this.e/H))*H,M=v[M])for(;M%10==0;M/=10,_--);return _<0&&(_=0),_},r.dividedBy=r.div=function(h,p){return t(this,new A(h,p),s,l)},r.dividedToIntegerBy=r.idiv=function(h,p){return t(this,new A(h,p),0,1)},r.exponentiatedBy=r.pow=function(h,p){var v,_,M,I,y,g,m,x,E,$=this;if(h=new A(h),h.c&&!h.isInteger())throw Error(pt+"Exponent not an integer: "+B(h));if(p!=null&&(p=new A(p)),g=h.e>14,!$.c||!$.c[0]||$.c[0]==1&&!$.e&&$.c.length==1||!h.c||!h.c[0])return E=new A(Math.pow(+B($),g?h.s*(2-rn(h)):+B(h))),p?E.mod(p):E;if(m=h.s<0,p){if(p.c?!p.c[0]:!p.s)return new A(NaN);_=!m&&$.isInteger()&&p.isInteger(),_&&($=$.mod(p))}else{if(h.e>9&&($.e>0||$.e<-1||($.e==0?$.c[0]>1||g&&$.c[1]>=24e7:$.c[0]<8e13||g&&$.c[0]<=9999975e7)))return I=$.s<0&&rn(h)?-0:0,$.e>-1&&(I=1/I),new A(m?1/I:I);S&&(I=ai(S/H+2))}for(g?(v=new A(.5),m&&(h.s=1),x=rn(h)):(M=Math.abs(+B(h)),x=M%2),E=new A(o);;){if(x){if(E=E.times($),!E.c)break;I?E.c.length>I&&(E.c.length=I):_&&(E=E.mod(p))}if(M){if(M=St(M/2),M===0)break;x=M%2}else if(h=h.times(v),D(h,h.e+1,1),h.e>14)x=rn(h);else{if(M=+B(h),M===0)break;x=M%2}$=$.times($),I?$.c&&$.c.length>I&&($.c.length=I):_&&($=$.mod(p))}return _?E:(m&&(E=o.div(E)),p?E.mod(p):I?D(E,S,l,y):E)},r.integerValue=function(h){var p=new A(this);return h==null?h=l:J(h,0,8),D(p,p.e+1,h)},r.isEqualTo=r.eq=function(h,p){return te(this,new A(h,p))===0},r.isFinite=function(){return!!this.c},r.isGreaterThan=r.gt=function(h,p){return te(this,new A(h,p))>0},r.isGreaterThanOrEqualTo=r.gte=function(h,p){return(p=te(this,new A(h,p)))===1||p===0},r.isInteger=function(){return!!this.c&&Mt(this.e/H)>this.c.length-2},r.isLessThan=r.lt=function(h,p){return te(this,new A(h,p))<0},r.isLessThanOrEqualTo=r.lte=function(h,p){return(p=te(this,new A(h,p)))===-1||p===0},r.isNaN=function(){return!this.s},r.isNegative=function(){return this.s<0},r.isPositive=function(){return this.s>0},r.isZero=function(){return!!this.c&&this.c[0]==0},r.minus=function(h,p){var v,_,M,I,y=this,g=y.s;if(h=new A(h,p),p=h.s,!g||!p)return new A(NaN);if(g!=p)return h.s=-p,y.plus(h);var m=y.e/H,x=h.e/H,E=y.c,$=h.c;if(!m||!x){if(!E||!$)return E?(h.s=-p,h):new A($?y:NaN);if(!E[0]||!$[0])return $[0]?(h.s=-p,h):new A(E[0]?y:l==3?-0:0)}if(m=Mt(m),x=Mt(x),E=E.slice(),g=m-x){for((I=g<0)?(g=-g,M=E):(x=m,M=$),M.reverse(),p=g;p--;M.push(0));M.reverse()}else for(_=(I=(g=E.length)<(p=$.length))?g:p,g=p=0;p<_;p++)if(E[p]!=$[p]){I=E[p]<$[p];break}if(I&&(M=E,E=$,$=M,h.s=-h.s),p=(_=$.length)-(v=E.length),p>0)for(;p--;E[v++]=0);for(p=At-1;_>g;){if(E[--_]<$[_]){for(v=_;v&&!E[--v];E[v]=p);--E[v],E[_]+=At}E[_]-=$[_]}for(;E[0]==0;E.splice(0,1),--x);return E[0]?R(h,E,x):(h.s=l==3?-1:1,h.c=[h.e=0],h)},r.modulo=r.mod=function(h,p){var v,_,M=this;return h=new A(h,p),!M.c||!h.s||h.c&&!h.c[0]?new A(NaN):!h.c||M.c&&!M.c[0]?new A(M):(w==9?(_=h.s,h.s=1,v=t(M,h,0,3),h.s=_,v.s*=_):v=t(M,h,0,w),h=M.minus(v.times(h)),!h.c[0]&&w==1&&(h.s=M.s),h)},r.multipliedBy=r.times=function(h,p){var v,_,M,I,y,g,m,x,E,$,O,C,z,G,q,F=this,X=F.c,W=(h=new A(h,p)).c;if(!X||!W||!X[0]||!W[0])return!F.s||!h.s||X&&!X[0]&&!W||W&&!W[0]&&!X?h.c=h.e=h.s=null:(h.s*=F.s,!X||!W?h.c=h.e=null:(h.c=[0],h.e=0)),h;for(_=Mt(F.e/H)+Mt(h.e/H),h.s*=F.s,m=X.length,$=W.length,m<$&&(z=X,X=W,W=z,M=m,m=$,$=M),M=m+$,z=[];M--;z.push(0));for(G=At,q=jt,M=$;--M>=0;){for(v=0,O=W[M]%q,C=W[M]/q|0,y=m,I=M+y;I>M;)x=X[--y]%q,E=X[y]/q|0,g=C*x+E*O,x=O*x+g%q*q+z[I]+v,v=(x/G|0)+(g/q|0)+C*E,z[I--]=x%G;z[I]=v}return v?++_:z.splice(0,1),R(h,z,_)},r.negated=function(){var h=new A(this);return h.s=-h.s||null,h},r.plus=function(h,p){var v,_=this,M=_.s;if(h=new A(h,p),p=h.s,!M||!p)return new A(NaN);if(M!=p)return h.s=-p,_.minus(h);var I=_.e/H,y=h.e/H,g=_.c,m=h.c;if(!I||!y){if(!g||!m)return new A(M/0);if(!g[0]||!m[0])return m[0]?h:new A(g[0]?_:M*0)}if(I=Mt(I),y=Mt(y),g=g.slice(),M=I-y){for(M>0?(y=I,v=m):(M=-M,v=g),v.reverse();M--;v.push(0));v.reverse()}for(M=g.length,p=m.length,M-p<0&&(v=m,m=g,g=v,p=M),M=0;p;)M=(g[--p]=g[p]+m[p]+M)/At|0,g[p]=At===g[p]?0:g[p]%At;return M&&(g=[M].concat(g),++y),R(h,g,y)},r.precision=r.sd=function(h,p){var v,_,M,I=this;if(h!=null&&h!==!!h)return J(h,1,rt),p==null?p=l:J(p,0,8),D(new A(I),h,p);if(!(v=I.c))return null;if(M=v.length-1,_=M*H+1,M=v[M]){for(;M%10==0;M/=10,_--);for(M=v[0];M>=10;M/=10,_++);}return h&&I.e+1>_&&(_=I.e+1),_},r.shiftedBy=function(h){return J(h,-ui,ui),this.times("1e"+h)},r.squareRoot=r.sqrt=function(){var h,p,v,_,M,I=this,y=I.c,g=I.s,m=I.e,x=s+4,E=new A("0.5");if(g!==1||!y||!y[0])return new A(!g||g<0&&(!y||y[0])?NaN:y?I:1/0);if(g=Math.sqrt(+B(I)),g==0||g==1/0?(p=xt(y),(p.length+m)%2==0&&(p+="0"),g=Math.sqrt(+p),m=Mt((m+1)/2)-(m<0||m%2),g==1/0?p="5e"+m:(p=g.toExponential(),p=p.slice(0,p.indexOf("e")+1)+m),v=new A(p)):v=new A(g+""),v.c[0]){for(m=v.e,g=m+x,g<3&&(g=0);;)if(M=v,v=E.times(M.plus(t(I,M,x,1))),xt(M.c).slice(0,g)===(p=xt(v.c)).slice(0,g))if(v.e<m&&--g,p=p.slice(g-3,g+1),p=="9999"||!_&&p=="4999"){if(!_&&(D(M,M.e+s+2,0),M.times(M).eq(I))){v=M;break}x+=4,g+=4,_=1}else{(!+p||!+p.slice(1)&&p.charAt(0)=="5")&&(D(v,v.e+s+2,1),h=!v.times(v).eq(I));break}}return D(v,v.e+s+1,l,h)},r.toExponential=function(h,p){return h!=null&&(J(h,0,rt),h++),L(this,h,p,1)},r.toFixed=function(h,p){return h!=null&&(J(h,0,rt),h=h+this.e+1),L(this,h,p)},r.toFormat=function(h,p,v){var _,M=this;if(v==null)h!=null&&p&&typeof p=="object"?(v=p,p=null):h&&typeof h=="object"?(v=h,h=p=null):v=b;else if(typeof v!="object")throw Error(pt+"Argument not an object: "+v);if(_=M.toFixed(h,p),M.c){var I,y=_.split("."),g=+v.groupSize,m=+v.secondaryGroupSize,x=v.groupSeparator||"",E=y[0],$=y[1],O=M.s<0,C=O?E.slice(1):E,z=C.length;if(m&&(I=g,g=m,m=I,z-=I),g>0&&z>0){for(I=z%g||g,E=C.substr(0,I);I<z;I+=g)E+=x+C.substr(I,g);m>0&&(E+=x+C.slice(I)),O&&(E="-"+E)}_=$?E+(v.decimalSeparator||"")+((m=+v.fractionGroupSize)?$.replace(new RegExp("\\d{"+m+"}\\B","g"),"$&"+(v.fractionGroupSeparator||"")):$):E}return(v.prefix||"")+_+(v.suffix||"")},r.toFraction=function(h){var p,v,_,M,I,y,g,m,x,E,$,O,C=this,z=C.c;if(h!=null&&(g=new A(h),!g.isInteger()&&(g.c||g.s!==1)||g.lt(o)))throw Error(pt+"Argument "+(g.isInteger()?"out of range: ":"not an integer: ")+B(g));if(!z)return new A(C);for(p=new A(o),x=v=new A(o),_=m=new A(o),O=xt(z),I=p.e=O.length-C.e-1,p.c[0]=ci[(y=I%H)<0?H+y:y],h=!h||g.comparedTo(p)>0?I>0?p:x:g,y=f,f=1/0,g=new A(O),m.c[0]=0;E=t(g,p,0,1),M=v.plus(E.times(_)),M.comparedTo(h)!=1;)v=_,_=M,x=m.plus(E.times(M=x)),m=M,p=g.minus(E.times(M=p)),g=M;return M=t(h.minus(v),_,0,1),m=m.plus(M.times(x)),v=v.plus(M.times(_)),m.s=x.s=C.s,I=I*2,$=t(x,_,I,l).minus(C).abs().comparedTo(t(m,v,I,l).minus(C).abs())<1?[x,_]:[m,v],f=y,$},r.toNumber=function(){return+B(this)},r.toPrecision=function(h,p){return h!=null&&J(h,1,rt),L(this,h,p,2)},r.toString=function(h){var p,v=this,_=v.s,M=v.e;return M===null?_?(p="Infinity",_<0&&(p="-"+p)):p="NaN":(h==null?p=M<=a||M>=u?on(xt(v.c),M):Gt(xt(v.c),M,"0"):h===10&&N?(v=D(new A(v),s+M+1,l),p=Gt(xt(v.c),v.e,"0")):(J(h,2,P.length,"Base"),p=n(Gt(xt(v.c),M,"0"),10,h,_,!0)),_<0&&v.c[0]&&(p="-"+p)),p},r.valueOf=r.toJSON=function(){return B(this)},r._isBigNumber=!0,r[Symbol.toStringTag]="BigNumber",r[Symbol.for("nodejs.util.inspect.custom")]=r.valueOf,e!=null&&A.set(e),A}function Mt(e){var t=e|0;return e>0||e===t?t:t-1}function xt(e){for(var t,n,i=1,r=e.length,o=e[0]+"";i<r;){for(t=e[i++]+"",n=H-t.length;n--;t="0"+t);o+=t}for(r=o.length;o.charCodeAt(--r)===48;);return o.slice(0,r+1||1)}function te(e,t){var n,i,r=e.c,o=t.c,s=e.s,l=t.s,a=e.e,u=t.e;if(!s||!l)return null;if(n=r&&!r[0],i=o&&!o[0],n||i)return n?i?0:-l:s;if(s!=l)return s;if(n=s<0,i=a==u,!r||!o)return i?0:!r^n?1:-1;if(!i)return a>u^n?1:-1;for(l=(a=r.length)<(u=o.length)?a:u,s=0;s<l;s++)if(r[s]!=o[s])return r[s]>o[s]^n?1:-1;return a==u?0:a>u^n?1:-1}function J(e,t,n,i){if(e<t||e>n||e!==St(e))throw Error(pt+(i||"Argument")+(typeof e=="number"?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function rn(e){var t=e.c.length-1;return Mt(e.e/H)==t&&e.c[t]%2!=0}function on(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function Gt(e,t,n){var i,r;if(t<0){for(r=n+".";++t;r+=n);e=r+e}else if(i=e.length,++t>i){for(r=n,t-=i;--t;r+=n);e+=r}else t<i&&(e=e.slice(0,t)+"."+e.slice(t));return e}var Kl=Qo();const Vl=24,Be=32,jl=()=>typeof globalThis<"u"&&globalThis.crypto&&typeof globalThis.crypto.getRandomValues=="function"?()=>{const e=new Uint32Array(1);return globalThis.crypto.getRandomValues(e),e[0]/4294967296}:Math.random,cr=jl(),Ii=(e=4,t=cr)=>{let n="";for(;n.length<e;)n=n+Math.floor(t()*36).toString(36);return n};function Wl(e){let t=new Kl(0);for(const n of e.values())t=t.multipliedBy(256).plus(n);return t}const Zo=(e="")=>{const t=new TextEncoder;return Wl(Xl(t.encode(e))).toString(36).slice(1)},Br=Array.from({length:26},(e,t)=>String.fromCharCode(t+97)),Ql=e=>Br[Math.floor(e()*Br.length)],Zl=({globalObj:e=typeof global<"u"?global:typeof window<"u"?window:{},random:t=cr}={})=>{const n=Object.keys(e).toString(),i=n.length?n+Ii(Be,t):Ii(Be,t);return Zo(i).substring(0,Be)},Jl=e=>()=>e++,ta=476782367,fr=({random:e=cr,counter:t=Jl(Math.floor(e()*ta)),length:n=Vl,fingerprint:i=Zl({random:e})}={})=>{if(n>Be)throw new Error(`Length must be between 2 and ${Be}. Received: ${n}`);return function(){const o=Ql(e),s=Date.now().toString(36),l=t().toString(36),a=Ii(n,e),u=`${s+a+l+i}`;return`${o+Zo(u).substring(1,n)}`}};fr();const ea={DEV:!1,PROD:!0},zr=750,de=750,na="Orthographic",ia=500,ra=2,oa=25,sa=1,la=1,Jo=40,hr=384,Ai=1,dr=4,aa=Math.max(Math.floor(.1*hr),dr),ua=Math.min(.08,Math.sqrt(Math.PI/hr)),pr=ea||{},ca=pr.PROD??!1,fa=pr.DEV??!0,ts=pr.DEV??!0,ha=["#c0392b","#f1c40f","#9b59b6","#00b386","#cc6600","#0a4c8c"];function es(e,t){let n,i;for(const r of e)r!=null&&(n===void 0?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)));return[n,i]}class Tt{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const o=n[r],s=t+o,l=Math.abs(t)<Math.abs(o)?t-(s-o):o-(s-t);l&&(n[i++]=l),t=s}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,o,s=0;if(n>0){for(s=t[--n];n>0&&(i=s,r=t[--n],s=i+r,o=r-(s-i),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(r=o*2,i=s+r,r==i-s&&(s=i))}return s}}function Fr(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let o of e)(o=t(o,++r,e))!=null&&(o=+o)>=o&&(++n,i+=o)}if(n)return i/n}function*da(e){for(const t of e)yield*t}function ns(e){return Array.from(da(e))}function pe(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(r);++i<r;)o[i]=e+i*n;return o}var pa={value:()=>{}};function ei(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new wn(n)}function wn(e){this._=e}function ga(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}wn.prototype=ei.prototype={constructor:wn,on:function(e,t){var n=this._,i=ga(e+"",n),r,o=-1,s=i.length;if(arguments.length<2){for(;++o<s;)if((r=(e=i[o]).type)&&(r=ma(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(r=(e=i[o]).type)n[r]=Gr(n[r],e.name,t);else if(t==null)for(r in n)n[r]=Gr(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new wn(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,o;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],i=0,r=o.length;i<r;++i)o[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)}};function ma(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function Gr(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=pa,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var bi="http://www.w3.org/1999/xhtml";const Hr={svg:"http://www.w3.org/2000/svg",xhtml:bi,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ni(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Hr.hasOwnProperty(t)?{space:Hr[t],local:e}:e}function ya(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===bi&&t.documentElement.namespaceURI===bi?t.createElement(e):t.createElementNS(n,e)}}function wa(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function is(e){var t=ni(e);return(t.local?wa:ya)(t)}function va(){}function gr(e){return e==null?va:function(){return this.querySelector(e)}}function _a(e){typeof e!="function"&&(e=gr(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o=t[r],s=o.length,l=i[r]=new Array(s),a,u,c=0;c<s;++c)(a=o[c])&&(u=e.call(a,a.__data__,c,o))&&("__data__"in a&&(u.__data__=a.__data__),l[c]=u);return new wt(i,this._parents)}function xa(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Sa(){return[]}function rs(e){return e==null?Sa:function(){return this.querySelectorAll(e)}}function Ma(e){return function(){return xa(e.apply(this,arguments))}}function Ea(e){typeof e=="function"?e=Ma(e):e=rs(e);for(var t=this._groups,n=t.length,i=[],r=[],o=0;o<n;++o)for(var s=t[o],l=s.length,a,u=0;u<l;++u)(a=s[u])&&(i.push(e.call(a,a.__data__,u,s)),r.push(a));return new wt(i,r)}function os(e){return function(){return this.matches(e)}}function ss(e){return function(t){return t.matches(e)}}var Ia=Array.prototype.find;function Aa(e){return function(){return Ia.call(this.children,e)}}function ba(){return this.firstElementChild}function Na(e){return this.select(e==null?ba:Aa(typeof e=="function"?e:ss(e)))}var $a=Array.prototype.filter;function Ta(){return Array.from(this.children)}function ka(e){return function(){return $a.call(this.children,e)}}function Pa(e){return this.selectAll(e==null?Ta:ka(typeof e=="function"?e:ss(e)))}function La(e){typeof e!="function"&&(e=os(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o=t[r],s=o.length,l=i[r]=[],a,u=0;u<s;++u)(a=o[u])&&e.call(a,a.__data__,u,o)&&l.push(a);return new wt(i,this._parents)}function ls(e){return new Array(e.length)}function Oa(){return new wt(this._enter||this._groups.map(ls),this._parents)}function bn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}bn.prototype={constructor:bn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Da(e){return function(){return e}}function Ra(e,t,n,i,r,o){for(var s=0,l,a=t.length,u=o.length;s<u;++s)(l=t[s])?(l.__data__=o[s],i[s]=l):n[s]=new bn(e,o[s]);for(;s<a;++s)(l=t[s])&&(r[s]=l)}function Ca(e,t,n,i,r,o,s){var l,a,u=new Map,c=t.length,f=o.length,d=new Array(c),w;for(l=0;l<c;++l)(a=t[l])&&(d[l]=w=s.call(a,a.__data__,l,t)+"",u.has(w)?r[l]=a:u.set(w,a));for(l=0;l<f;++l)w=s.call(e,o[l],l,o)+"",(a=u.get(w))?(i[l]=a,a.__data__=o[l],u.delete(w)):n[l]=new bn(e,o[l]);for(l=0;l<c;++l)(a=t[l])&&u.get(d[l])===a&&(r[l]=a)}function Ba(e){return e.__data__}function za(e,t){if(!arguments.length)return Array.from(this,Ba);var n=t?Ca:Ra,i=this._parents,r=this._groups;typeof e!="function"&&(e=Da(e));for(var o=r.length,s=new Array(o),l=new Array(o),a=new Array(o),u=0;u<o;++u){var c=i[u],f=r[u],d=f.length,w=Fa(e.call(c,c&&c.__data__,u,i)),S=w.length,b=l[u]=new Array(S),P=s[u]=new Array(S),N=a[u]=new Array(d);n(c,f,b,P,N,w,t);for(var A=0,L=0,k,R;A<S;++A)if(k=b[A]){for(A>=L&&(L=A+1);!(R=P[L])&&++L<S;);k._next=R||null}}return s=new wt(s,i),s._enter=l,s._exit=a,s}function Fa(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ga(){return new wt(this._exit||this._groups.map(ls),this._parents)}function Ha(e,t,n){var i=this.enter(),r=this,o=this.exit();return typeof e=="function"?(i=e(i),i&&(i=i.selection())):i=i.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?o.remove():n(o),i&&r?i.merge(r).order():r}function qa(e){for(var t=e.selection?e.selection():e,n=this._groups,i=t._groups,r=n.length,o=i.length,s=Math.min(r,o),l=new Array(r),a=0;a<s;++a)for(var u=n[a],c=i[a],f=u.length,d=l[a]=new Array(f),w,S=0;S<f;++S)(w=u[S]||c[S])&&(d[S]=w);for(;a<r;++a)l[a]=n[a];return new wt(l,this._parents)}function Ua(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var i=e[t],r=i.length-1,o=i[r],s;--r>=0;)(s=i[r])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function Xa(e){e||(e=Ya);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var s=n[o],l=s.length,a=r[o]=new Array(l),u,c=0;c<l;++c)(u=s[c])&&(a[c]=u);a.sort(t)}return new wt(r,this._parents).order()}function Ya(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ka(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Va(){return Array.from(this)}function ja(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null}function Wa(){let e=0;for(const t of this)++e;return e}function Qa(){return!this.node()}function Za(e){for(var t=this._groups,n=0,i=t.length;n<i;++n)for(var r=t[n],o=0,s=r.length,l;o<s;++o)(l=r[o])&&e.call(l,l.__data__,o,r);return this}function Ja(e){return function(){this.removeAttribute(e)}}function tu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function eu(e,t){return function(){this.setAttribute(e,t)}}function nu(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function iu(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function ru(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function ou(e,t){var n=ni(e);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((t==null?n.local?tu:Ja:typeof t=="function"?n.local?ru:iu:n.local?nu:eu)(n,t))}function as(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function su(e){return function(){this.style.removeProperty(e)}}function lu(e,t,n){return function(){this.style.setProperty(e,t,n)}}function au(e,t,n){return function(){var i=t.apply(this,arguments);i==null?this.style.removeProperty(e):this.style.setProperty(e,i,n)}}function uu(e,t,n){return arguments.length>1?this.each((t==null?su:typeof t=="function"?au:lu)(e,t,n??"")):ve(this.node(),e)}function ve(e,t){return e.style.getPropertyValue(t)||as(e).getComputedStyle(e,null).getPropertyValue(t)}function cu(e){return function(){delete this[e]}}function fu(e,t){return function(){this[e]=t}}function hu(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function du(e,t){return arguments.length>1?this.each((t==null?cu:typeof t=="function"?hu:fu)(e,t)):this.node()[e]}function us(e){return e.trim().split(/^|\s+/)}function mr(e){return e.classList||new cs(e)}function cs(e){this._node=e,this._names=us(e.getAttribute("class")||"")}cs.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function fs(e,t){for(var n=mr(e),i=-1,r=t.length;++i<r;)n.add(t[i])}function hs(e,t){for(var n=mr(e),i=-1,r=t.length;++i<r;)n.remove(t[i])}function pu(e){return function(){fs(this,e)}}function gu(e){return function(){hs(this,e)}}function mu(e,t){return function(){(t.apply(this,arguments)?fs:hs)(this,e)}}function yu(e,t){var n=us(e+"");if(arguments.length<2){for(var i=mr(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?mu:t?pu:gu)(n,t))}function wu(){this.textContent=""}function vu(e){return function(){this.textContent=e}}function _u(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function xu(e){return arguments.length?this.each(e==null?wu:(typeof e=="function"?_u:vu)(e)):this.node().textContent}function Su(){this.innerHTML=""}function Mu(e){return function(){this.innerHTML=e}}function Eu(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Iu(e){return arguments.length?this.each(e==null?Su:(typeof e=="function"?Eu:Mu)(e)):this.node().innerHTML}function Au(){this.nextSibling&&this.parentNode.appendChild(this)}function bu(){return this.each(Au)}function Nu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function $u(){return this.each(Nu)}function Tu(e){var t=typeof e=="function"?e:is(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function ku(){return null}function Pu(e,t){var n=typeof e=="function"?e:is(e),i=t==null?ku:typeof t=="function"?t:gr(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function Lu(){var e=this.parentNode;e&&e.removeChild(this)}function Ou(){return this.each(Lu)}function Du(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ru(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Cu(e){return this.select(e?Ru:Du)}function Bu(e){return arguments.length?this.property("__data__",e):this.node().__data__}function zu(e){return function(t){e.call(this,t,this.__data__)}}function Fu(e){return e.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");return i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),{type:t,name:n}})}function Gu(e){return function(){var t=this.__on;if(t){for(var n=0,i=-1,r=t.length,o;n<r;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++i]=o;++i?t.length=i:delete this.__on}}}function Hu(e,t,n){return function(){var i=this.__on,r,o=zu(t);if(i){for(var s=0,l=i.length;s<l;++s)if((r=i[s]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),r.value=t;return}}this.addEventListener(e.type,o,n),r={type:e.type,name:e.name,value:t,listener:o,options:n},i?i.push(r):this.__on=[r]}}function qu(e,t,n){var i=Fu(e+""),r,o=i.length,s;if(arguments.length<2){var l=this.node().__on;if(l){for(var a=0,u=l.length,c;a<u;++a)for(r=0,c=l[a];r<o;++r)if((s=i[r]).type===c.type&&s.name===c.name)return c.value}return}for(l=t?Hu:Gu,r=0;r<o;++r)this.each(l(i[r],t,n));return this}function ds(e,t,n){var i=as(e),r=i.CustomEvent;typeof r=="function"?r=new r(t,n):(r=i.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function Uu(e,t){return function(){return ds(this,e,t)}}function Xu(e,t){return function(){return ds(this,e,t.apply(this,arguments))}}function Yu(e,t){return this.each((typeof t=="function"?Xu:Uu)(e,t))}function*Ku(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],r=0,o=i.length,s;r<o;++r)(s=i[r])&&(yield s)}var ps=[null];function wt(e,t){this._groups=e,this._parents=t}function We(){return new wt([[document.documentElement]],ps)}function Vu(){return this}wt.prototype=We.prototype={constructor:wt,select:_a,selectAll:Ea,selectChild:Na,selectChildren:Pa,filter:La,data:za,enter:Oa,exit:Ga,join:Ha,merge:qa,selection:Vu,order:Ua,sort:Xa,call:Ka,nodes:Va,node:ja,size:Wa,empty:Qa,each:Za,attr:ou,style:uu,property:du,classed:yu,text:xu,html:Iu,raise:bu,lower:$u,append:Tu,insert:Pu,remove:Ou,clone:Cu,datum:Bu,on:qu,dispatch:Yu,[Symbol.iterator]:Ku};function et(e){return typeof e=="string"?new wt([[document.querySelector(e)]],[document.documentElement]):new wt([[e]],ps)}function gs(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Lt(e,t){if(e=gs(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}function ju(e,t){return e.target&&(e=gs(e),t===void 0&&(t=e.currentTarget),e=e.touches||[e]),Array.from(e,n=>Lt(n,t))}const Wu={passive:!1},Fe={capture:!0,passive:!1};function fi(e){e.stopImmediatePropagation()}function ye(e){e.preventDefault(),e.stopImmediatePropagation()}function ms(e){var t=e.document.documentElement,n=et(e).on("dragstart.drag",ye,Fe);"onselectstart"in t?n.on("selectstart.drag",ye,Fe):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function ys(e,t){var n=e.document.documentElement,i=et(e).on("dragstart.drag",null);t&&(i.on("click.drag",ye,Fe),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const sn=e=>()=>e;function Ni(e,{sourceEvent:t,subject:n,target:i,identifier:r,active:o,x:s,y:l,dx:a,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:a,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}Ni.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Qu(e){return!e.ctrlKey&&!e.button}function Zu(){return this.parentNode}function Ju(e,t){return t??{x:e.x,y:e.y}}function tc(){return navigator.maxTouchPoints||"ontouchstart"in this}function ec(){var e=Qu,t=Zu,n=Ju,i=tc,r={},o=ei("start","drag","end"),s=0,l,a,u,c,f=0;function d(k){k.on("mousedown.drag",w).filter(i).on("touchstart.drag",P).on("touchmove.drag",N,Wu).on("touchend.drag touchcancel.drag",A).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function w(k,R){if(!(c||!e.call(this,k,R))){var D=L(this,t.call(this,k,R),k,R,"mouse");D&&(et(k.view).on("mousemove.drag",S,Fe).on("mouseup.drag",b,Fe),ms(k.view),fi(k),u=!1,l=k.clientX,a=k.clientY,D("start",k))}}function S(k){if(ye(k),!u){var R=k.clientX-l,D=k.clientY-a;u=R*R+D*D>f}r.mouse("drag",k)}function b(k){et(k.view).on("mousemove.drag mouseup.drag",null),ys(k.view,u),ye(k),r.mouse("end",k)}function P(k,R){if(e.call(this,k,R)){var D=k.changedTouches,B=t.call(this,k,R),h=D.length,p,v;for(p=0;p<h;++p)(v=L(this,B,k,R,D[p].identifier,D[p]))&&(fi(k),v("start",k,D[p]))}}function N(k){var R=k.changedTouches,D=R.length,B,h;for(B=0;B<D;++B)(h=r[R[B].identifier])&&(ye(k),h("drag",k,R[B]))}function A(k){var R=k.changedTouches,D=R.length,B,h;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),B=0;B<D;++B)(h=r[R[B].identifier])&&(fi(k),h("end",k,R[B]))}function L(k,R,D,B,h,p){var v=o.copy(),_=Lt(p||D,R),M,I,y;if((y=n.call(k,new Ni("beforestart",{sourceEvent:D,target:d,identifier:h,active:s,x:_[0],y:_[1],dx:0,dy:0,dispatch:v}),B))!=null)return M=y.x-_[0]||0,I=y.y-_[1]||0,function g(m,x,E){var $=_,O;switch(m){case"start":r[h]=g,O=s++;break;case"end":delete r[h],--s;case"drag":_=Lt(E||x,R),O=s;break}v.call(m,k,new Ni(m,{sourceEvent:x,subject:y,target:d,identifier:h,active:O,x:_[0]+M,y:_[1]+I,dx:_[0]-$[0],dy:_[1]-$[1],dispatch:v}),B)}}return d.filter=function(k){return arguments.length?(e=typeof k=="function"?k:sn(!!k),d):e},d.container=function(k){return arguments.length?(t=typeof k=="function"?k:sn(k),d):t},d.subject=function(k){return arguments.length?(n=typeof k=="function"?k:sn(k),d):n},d.touchable=function(k){return arguments.length?(i=typeof k=="function"?k:sn(!!k),d):i},d.on=function(){var k=o.on.apply(o,arguments);return k===o?d:k},d.clickDistance=function(k){return arguments.length?(f=(k=+k)*k,d):Math.sqrt(f)},d}function yr(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ws(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function Qe(){}var Ge=.7,Nn=1/Ge,we="\\s*([+-]?\\d+)\\s*",He="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ct="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",nc=/^#([0-9a-f]{3,8})$/,ic=new RegExp(`^rgb\\(${we},${we},${we}\\)$`),rc=new RegExp(`^rgb\\(${Ct},${Ct},${Ct}\\)$`),oc=new RegExp(`^rgba\\(${we},${we},${we},${He}\\)$`),sc=new RegExp(`^rgba\\(${Ct},${Ct},${Ct},${He}\\)$`),lc=new RegExp(`^hsl\\(${He},${Ct},${Ct}\\)$`),ac=new RegExp(`^hsla\\(${He},${Ct},${Ct},${He}\\)$`),qr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};yr(Qe,qe,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Ur,formatHex:Ur,formatHex8:uc,formatHsl:cc,formatRgb:Xr,toString:Xr});function Ur(){return this.rgb().formatHex()}function uc(){return this.rgb().formatHex8()}function cc(){return vs(this).formatHsl()}function Xr(){return this.rgb().formatRgb()}function qe(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=nc.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Yr(t):n===3?new mt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?ln(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?ln(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ic.exec(e))?new mt(t[1],t[2],t[3],1):(t=rc.exec(e))?new mt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=oc.exec(e))?ln(t[1],t[2],t[3],t[4]):(t=sc.exec(e))?ln(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=lc.exec(e))?jr(t[1],t[2]/100,t[3]/100,1):(t=ac.exec(e))?jr(t[1],t[2]/100,t[3]/100,t[4]):qr.hasOwnProperty(e)?Yr(qr[e]):e==="transparent"?new mt(NaN,NaN,NaN,0):null}function Yr(e){return new mt(e>>16&255,e>>8&255,e&255,1)}function ln(e,t,n,i){return i<=0&&(e=t=n=NaN),new mt(e,t,n,i)}function fc(e){return e instanceof Qe||(e=qe(e)),e?(e=e.rgb(),new mt(e.r,e.g,e.b,e.opacity)):new mt}function $i(e,t,n,i){return arguments.length===1?fc(e):new mt(e,t,n,i??1)}function mt(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}yr(mt,$i,ws(Qe,{brighter(e){return e=e==null?Nn:Math.pow(Nn,e),new mt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ge:Math.pow(Ge,e),new mt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new mt(oe(this.r),oe(this.g),oe(this.b),$n(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Kr,formatHex:Kr,formatHex8:hc,formatRgb:Vr,toString:Vr}));function Kr(){return`#${ee(this.r)}${ee(this.g)}${ee(this.b)}`}function hc(){return`#${ee(this.r)}${ee(this.g)}${ee(this.b)}${ee((isNaN(this.opacity)?1:this.opacity)*255)}`}function Vr(){const e=$n(this.opacity);return`${e===1?"rgb(":"rgba("}${oe(this.r)}, ${oe(this.g)}, ${oe(this.b)}${e===1?")":`, ${e})`}`}function $n(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function oe(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ee(e){return e=oe(e),(e<16?"0":"")+e.toString(16)}function jr(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Nt(e,t,n,i)}function vs(e){if(e instanceof Nt)return new Nt(e.h,e.s,e.l,e.opacity);if(e instanceof Qe||(e=qe(e)),!e)return new Nt;if(e instanceof Nt)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),s=NaN,l=o-r,a=(o+r)/2;return l?(t===o?s=(n-i)/l+(n<i)*6:n===o?s=(i-t)/l+2:s=(t-n)/l+4,l/=a<.5?o+r:2-o-r,s*=60):l=a>0&&a<1?0:s,new Nt(s,l,a,e.opacity)}function dc(e,t,n,i){return arguments.length===1?vs(e):new Nt(e,t,n,i??1)}function Nt(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}yr(Nt,dc,ws(Qe,{brighter(e){return e=e==null?Nn:Math.pow(Nn,e),new Nt(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ge:Math.pow(Ge,e),new Nt(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new mt(hi(e>=240?e-240:e+120,r,i),hi(e,r,i),hi(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new Nt(Wr(this.h),an(this.s),an(this.l),$n(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=$n(this.opacity);return`${e===1?"hsl(":"hsla("}${Wr(this.h)}, ${an(this.s)*100}%, ${an(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Wr(e){return e=(e||0)%360,e<0?e+360:e}function an(e){return Math.max(0,Math.min(1,e||0))}function hi(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const _s=e=>()=>e;function pc(e,t){return function(n){return e+n*t}}function gc(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function mc(e){return(e=+e)==1?xs:function(t,n){return n-t?gc(t,n,e):_s(isNaN(t)?n:t)}}function xs(e,t){var n=t-e;return n?pc(e,n):_s(isNaN(e)?t:e)}const Qr=(function e(t){var n=mc(t);function i(r,o){var s=n((r=$i(r)).r,(o=$i(o)).r),l=n(r.g,o.g),a=n(r.b,o.b),u=xs(r.opacity,o.opacity);return function(c){return r.r=s(c),r.g=l(c),r.b=a(c),r.opacity=u(c),r+""}}return i.gamma=e,i})(1);function Wt(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Ti=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,di=new RegExp(Ti.source,"g");function yc(e){return function(){return e}}function wc(e){return function(t){return e(t)+""}}function vc(e,t){var n=Ti.lastIndex=di.lastIndex=0,i,r,o,s=-1,l=[],a=[];for(e=e+"",t=t+"";(i=Ti.exec(e))&&(r=di.exec(t));)(o=r.index)>n&&(o=t.slice(n,o),l[s]?l[s]+=o:l[++s]=o),(i=i[0])===(r=r[0])?l[s]?l[s]+=r:l[++s]=r:(l[++s]=null,a.push({i:s,x:Wt(i,r)})),n=di.lastIndex;return n<t.length&&(o=t.slice(n),l[s]?l[s]+=o:l[++s]=o),l.length<2?a[0]?wc(a[0].x):yc(t):(t=a.length,function(u){for(var c=0,f;c<t;++c)l[(f=a[c]).i]=f.x(u);return l.join("")})}var Zr=180/Math.PI,ki={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ss(e,t,n,i,r,o){var s,l,a;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(a=e*n+t*i)&&(n-=e*a,i-=t*a),(l=Math.sqrt(n*n+i*i))&&(n/=l,i/=l,a/=l),e*i<t*n&&(e=-e,t=-t,a=-a,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(t,e)*Zr,skewX:Math.atan(a)*Zr,scaleX:s,scaleY:l}}var un;function _c(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?ki:Ss(t.a,t.b,t.c,t.d,t.e,t.f)}function xc(e){return e==null||(un||(un=document.createElementNS("http://www.w3.org/2000/svg","g")),un.setAttribute("transform",e),!(e=un.transform.baseVal.consolidate()))?ki:(e=e.matrix,Ss(e.a,e.b,e.c,e.d,e.e,e.f))}function Ms(e,t,n,i){function r(u){return u.length?u.pop()+" ":""}function o(u,c,f,d,w,S){if(u!==f||c!==d){var b=w.push("translate(",null,t,null,n);S.push({i:b-4,x:Wt(u,f)},{i:b-2,x:Wt(c,d)})}else(f||d)&&w.push("translate("+f+t+d+n)}function s(u,c,f,d){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),d.push({i:f.push(r(f)+"rotate(",null,i)-2,x:Wt(u,c)})):c&&f.push(r(f)+"rotate("+c+i)}function l(u,c,f,d){u!==c?d.push({i:f.push(r(f)+"skewX(",null,i)-2,x:Wt(u,c)}):c&&f.push(r(f)+"skewX("+c+i)}function a(u,c,f,d,w,S){if(u!==f||c!==d){var b=w.push(r(w)+"scale(",null,",",null,")");S.push({i:b-4,x:Wt(u,f)},{i:b-2,x:Wt(c,d)})}else(f!==1||d!==1)&&w.push(r(w)+"scale("+f+","+d+")")}return function(u,c){var f=[],d=[];return u=e(u),c=e(c),o(u.translateX,u.translateY,c.translateX,c.translateY,f,d),s(u.rotate,c.rotate,f,d),l(u.skewX,c.skewX,f,d),a(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,d),u=c=null,function(w){for(var S=-1,b=d.length,P;++S<b;)f[(P=d[S]).i]=P.x(w);return f.join("")}}}var Sc=Ms(_c,"px, ","px)","deg)"),Mc=Ms(xc,", ",")",")"),Ec=1e-12;function Jr(e){return((e=Math.exp(e))+1/e)/2}function Ic(e){return((e=Math.exp(e))-1/e)/2}function Ac(e){return((e=Math.exp(2*e))-1)/(e+1)}const bc=(function e(t,n,i){function r(o,s){var l=o[0],a=o[1],u=o[2],c=s[0],f=s[1],d=s[2],w=c-l,S=f-a,b=w*w+S*S,P,N;if(b<Ec)N=Math.log(d/u)/t,P=function(B){return[l+B*w,a+B*S,u*Math.exp(t*B*N)]};else{var A=Math.sqrt(b),L=(d*d-u*u+i*b)/(2*u*n*A),k=(d*d-u*u-i*b)/(2*d*n*A),R=Math.log(Math.sqrt(L*L+1)-L),D=Math.log(Math.sqrt(k*k+1)-k);N=(D-R)/t,P=function(B){var h=B*N,p=Jr(R),v=u/(n*A)*(p*Ac(t*h+R)-Ic(R));return[l+v*w,a+v*S,u*p/Jr(t*h+R)]}}return P.duration=N*1e3*t/Math.SQRT2,P}return r.rho=function(o){var s=Math.max(.001,+o),l=s*s,a=l*l;return e(s,l,a)},r})(Math.SQRT2,2,4);var _e=0,Te=0,be=0,Es=1e3,Tn,ke,kn=0,le=0,ii=0,Ue=typeof performance=="object"&&performance.now?performance:Date,Is=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function wr(){return le||(Is(Nc),le=Ue.now()+ii)}function Nc(){le=0}function Pn(){this._call=this._time=this._next=null}Pn.prototype=As.prototype={constructor:Pn,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?wr():+n)+(t==null?0:+t),!this._next&&ke!==this&&(ke?ke._next=this:Tn=this,ke=this),this._call=e,this._time=n,Pi()},stop:function(){this._call&&(this._call=null,this._time=1/0,Pi())}};function As(e,t,n){var i=new Pn;return i.restart(e,t,n),i}function $c(){wr(),++_e;for(var e=Tn,t;e;)(t=le-e._time)>=0&&e._call.call(void 0,t),e=e._next;--_e}function to(){le=(kn=Ue.now())+ii,_e=Te=0;try{$c()}finally{_e=0,kc(),le=0}}function Tc(){var e=Ue.now(),t=e-kn;t>Es&&(ii-=t,kn=e)}function kc(){for(var e,t=Tn,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Tn=n);ke=e,Pi(i)}function Pi(e){if(!_e){Te&&(Te=clearTimeout(Te));var t=e-le;t>24?(e<1/0&&(Te=setTimeout(to,e-Ue.now()-ii)),be&&(be=clearInterval(be))):(be||(kn=Ue.now(),be=setInterval(Tc,Es)),_e=1,Is(to))}}function eo(e,t,n){var i=new Pn;return t=t==null?0:+t,i.restart(r=>{i.stop(),e(r+t)},t,n),i}var Pc=ei("start","end","cancel","interrupt"),Lc=[],bs=0,no=1,Li=2,vn=3,io=4,Oi=5,_n=6;function ri(e,t,n,i,r,o){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;Oc(e,n,{name:t,index:i,group:r,on:Pc,tween:Lc,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:bs})}function vr(e,t){var n=kt(e,t);if(n.state>bs)throw new Error("too late; already scheduled");return n}function zt(e,t){var n=kt(e,t);if(n.state>vn)throw new Error("too late; already running");return n}function kt(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Oc(e,t,n){var i=e.__transition,r;i[t]=n,n.timer=As(o,0,n.time);function o(u){n.state=no,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var c,f,d,w;if(n.state!==no)return a();for(c in i)if(w=i[c],w.name===n.name){if(w.state===vn)return eo(s);w.state===io?(w.state=_n,w.timer.stop(),w.on.call("interrupt",e,e.__data__,w.index,w.group),delete i[c]):+c<t&&(w.state=_n,w.timer.stop(),w.on.call("cancel",e,e.__data__,w.index,w.group),delete i[c])}if(eo(function(){n.state===vn&&(n.state=io,n.timer.restart(l,n.delay,n.time),l(u))}),n.state=Li,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Li){for(n.state=vn,r=new Array(d=n.tween.length),c=0,f=-1;c<d;++c)(w=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++f]=w);r.length=f+1}}function l(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(a),n.state=Oi,1),f=-1,d=r.length;++f<d;)r[f].call(e,c);n.state===Oi&&(n.on.call("end",e,e.__data__,n.index,n.group),a())}function a(){n.state=_n,n.timer.stop(),delete i[t];for(var u in i)return;delete e.__transition}}function xn(e,t){var n=e.__transition,i,r,o=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((i=n[s]).name!==t){o=!1;continue}r=i.state>Li&&i.state<Oi,i.state=_n,i.timer.stop(),i.on.call(r?"interrupt":"cancel",e,e.__data__,i.index,i.group),delete n[s]}o&&delete e.__transition}}function Dc(e){return this.each(function(){xn(this,e)})}function Rc(e,t){var n,i;return function(){var r=zt(this,e),o=r.tween;if(o!==n){i=n=o;for(var s=0,l=i.length;s<l;++s)if(i[s].name===t){i=i.slice(),i.splice(s,1);break}}r.tween=i}}function Cc(e,t,n){var i,r;if(typeof n!="function")throw new Error;return function(){var o=zt(this,e),s=o.tween;if(s!==i){r=(i=s).slice();for(var l={name:t,value:n},a=0,u=r.length;a<u;++a)if(r[a].name===t){r[a]=l;break}a===u&&r.push(l)}o.tween=r}}function Bc(e,t){var n=this._id;if(e+="",arguments.length<2){for(var i=kt(this.node(),n).tween,r=0,o=i.length,s;r<o;++r)if((s=i[r]).name===e)return s.value;return null}return this.each((t==null?Rc:Cc)(n,e,t))}function _r(e,t,n){var i=e._id;return e.each(function(){var r=zt(this,i);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return kt(r,i).value[t]}}function Ns(e,t){var n;return(typeof t=="number"?Wt:t instanceof qe?Qr:(n=qe(t))?(t=n,Qr):vc)(e,t)}function zc(e){return function(){this.removeAttribute(e)}}function Fc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Gc(e,t,n){var i,r=n+"",o;return function(){var s=this.getAttribute(e);return s===r?null:s===i?o:o=t(i=s,n)}}function Hc(e,t,n){var i,r=n+"",o;return function(){var s=this.getAttributeNS(e.space,e.local);return s===r?null:s===i?o:o=t(i=s,n)}}function qc(e,t,n){var i,r,o;return function(){var s,l=n(this),a;return l==null?void this.removeAttribute(e):(s=this.getAttribute(e),a=l+"",s===a?null:s===i&&a===r?o:(r=a,o=t(i=s,l)))}}function Uc(e,t,n){var i,r,o;return function(){var s,l=n(this),a;return l==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),a=l+"",s===a?null:s===i&&a===r?o:(r=a,o=t(i=s,l)))}}function Xc(e,t){var n=ni(e),i=n==="transform"?Mc:Ns;return this.attrTween(e,typeof t=="function"?(n.local?Uc:qc)(n,i,_r(this,"attr."+e,t)):t==null?(n.local?Fc:zc)(n):(n.local?Hc:Gc)(n,i,t))}function Yc(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Kc(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Vc(e,t){var n,i;function r(){var o=t.apply(this,arguments);return o!==i&&(n=(i=o)&&Kc(e,o)),n}return r._value=t,r}function jc(e,t){var n,i;function r(){var o=t.apply(this,arguments);return o!==i&&(n=(i=o)&&Yc(e,o)),n}return r._value=t,r}function Wc(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var i=ni(e);return this.tween(n,(i.local?Vc:jc)(i,t))}function Qc(e,t){return function(){vr(this,e).delay=+t.apply(this,arguments)}}function Zc(e,t){return t=+t,function(){vr(this,e).delay=t}}function Jc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Qc:Zc)(t,e)):kt(this.node(),t).delay}function tf(e,t){return function(){zt(this,e).duration=+t.apply(this,arguments)}}function ef(e,t){return t=+t,function(){zt(this,e).duration=t}}function nf(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?tf:ef)(t,e)):kt(this.node(),t).duration}function rf(e,t){if(typeof t!="function")throw new Error;return function(){zt(this,e).ease=t}}function of(e){var t=this._id;return arguments.length?this.each(rf(t,e)):kt(this.node(),t).ease}function sf(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;zt(this,e).ease=n}}function lf(e){if(typeof e!="function")throw new Error;return this.each(sf(this._id,e))}function af(e){typeof e!="function"&&(e=os(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o=t[r],s=o.length,l=i[r]=[],a,u=0;u<s;++u)(a=o[u])&&e.call(a,a.__data__,u,o)&&l.push(a);return new Yt(i,this._parents,this._name,this._id)}function uf(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,i=t.length,r=n.length,o=Math.min(i,r),s=new Array(i),l=0;l<o;++l)for(var a=t[l],u=n[l],c=a.length,f=s[l]=new Array(c),d,w=0;w<c;++w)(d=a[w]||u[w])&&(f[w]=d);for(;l<i;++l)s[l]=t[l];return new Yt(s,this._parents,this._name,this._id)}function cf(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function ff(e,t,n){var i,r,o=cf(t)?vr:zt;return function(){var s=o(this,e),l=s.on;l!==i&&(r=(i=l).copy()).on(t,n),s.on=r}}function hf(e,t){var n=this._id;return arguments.length<2?kt(this.node(),n).on.on(e):this.each(ff(n,e,t))}function df(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function pf(){return this.on("end.remove",df(this._id))}function gf(e){var t=this._name,n=this._id;typeof e!="function"&&(e=gr(e));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var l=i[s],a=l.length,u=o[s]=new Array(a),c,f,d=0;d<a;++d)(c=l[d])&&(f=e.call(c,c.__data__,d,l))&&("__data__"in c&&(f.__data__=c.__data__),u[d]=f,ri(u[d],t,n,d,u,kt(c,n)));return new Yt(o,this._parents,t,n)}function mf(e){var t=this._name,n=this._id;typeof e!="function"&&(e=rs(e));for(var i=this._groups,r=i.length,o=[],s=[],l=0;l<r;++l)for(var a=i[l],u=a.length,c,f=0;f<u;++f)if(c=a[f]){for(var d=e.call(c,c.__data__,f,a),w,S=kt(c,n),b=0,P=d.length;b<P;++b)(w=d[b])&&ri(w,t,n,b,d,S);o.push(d),s.push(c)}return new Yt(o,s,t,n)}var yf=We.prototype.constructor;function wf(){return new yf(this._groups,this._parents)}function vf(e,t){var n,i,r;return function(){var o=ve(this,e),s=(this.style.removeProperty(e),ve(this,e));return o===s?null:o===n&&s===i?r:r=t(n=o,i=s)}}function $s(e){return function(){this.style.removeProperty(e)}}function _f(e,t,n){var i,r=n+"",o;return function(){var s=ve(this,e);return s===r?null:s===i?o:o=t(i=s,n)}}function xf(e,t,n){var i,r,o;return function(){var s=ve(this,e),l=n(this),a=l+"";return l==null&&(a=l=(this.style.removeProperty(e),ve(this,e))),s===a?null:s===i&&a===r?o:(r=a,o=t(i=s,l))}}function Sf(e,t){var n,i,r,o="style."+t,s="end."+o,l;return function(){var a=zt(this,e),u=a.on,c=a.value[o]==null?l||(l=$s(t)):void 0;(u!==n||r!==c)&&(i=(n=u).copy()).on(s,r=c),a.on=i}}function Mf(e,t,n){var i=(e+="")=="transform"?Sc:Ns;return t==null?this.styleTween(e,vf(e,i)).on("end.style."+e,$s(e)):typeof t=="function"?this.styleTween(e,xf(e,i,_r(this,"style."+e,t))).each(Sf(this._id,e)):this.styleTween(e,_f(e,i,t),n).on("end.style."+e,null)}function Ef(e,t,n){return function(i){this.style.setProperty(e,t.call(this,i),n)}}function If(e,t,n){var i,r;function o(){var s=t.apply(this,arguments);return s!==r&&(i=(r=s)&&Ef(e,s,n)),i}return o._value=t,o}function Af(e,t,n){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;return this.tween(i,If(e,t,n??""))}function bf(e){return function(){this.textContent=e}}function Nf(e){return function(){var t=e(this);this.textContent=t??""}}function $f(e){return this.tween("text",typeof e=="function"?Nf(_r(this,"text",e)):bf(e==null?"":e+""))}function Tf(e){return function(t){this.textContent=e.call(this,t)}}function kf(e){var t,n;function i(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&Tf(r)),t}return i._value=e,i}function Pf(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,kf(e))}function Lf(){for(var e=this._name,t=this._id,n=Ts(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],l=s.length,a,u=0;u<l;++u)if(a=s[u]){var c=kt(a,t);ri(a,e,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Yt(i,this._parents,e,n)}function Of(){var e,t,n=this,i=n._id,r=n.size();return new Promise(function(o,s){var l={value:s},a={value:function(){--r===0&&o()}};n.each(function(){var u=zt(this,i),c=u.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(a)),u.on=t}),r===0&&o()})}var Df=0;function Yt(e,t,n,i){this._groups=e,this._parents=t,this._name=n,this._id=i}function Ts(){return++Df}var Ht=We.prototype;Yt.prototype={constructor:Yt,select:gf,selectAll:mf,selectChild:Ht.selectChild,selectChildren:Ht.selectChildren,filter:af,merge:uf,selection:wf,transition:Lf,call:Ht.call,nodes:Ht.nodes,node:Ht.node,size:Ht.size,empty:Ht.empty,each:Ht.each,on:hf,attr:Xc,attrTween:Wc,style:Mf,styleTween:Af,text:$f,textTween:Pf,remove:pf,tween:Bc,delay:Jc,duration:nf,ease:of,easeVarying:lf,end:Of,[Symbol.iterator]:Ht[Symbol.iterator]};function Rf(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Cf={time:null,delay:0,duration:250,ease:Rf};function Bf(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function zf(e){var t,n;e instanceof Yt?(t=e._id,e=e._name):(t=Ts(),(n=Cf).time=wr(),e=e==null?null:e+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],l=s.length,a,u=0;u<l;++u)(a=s[u])&&ri(a,e,t,u,s,n||Bf(a,t));return new Yt(i,this._parents,e,t)}We.prototype.interrupt=Dc;We.prototype.transition=zf;const Xt=11102230246251565e-32,ot=134217729,Ff=(3+8*Xt)*Xt;function pi(e,t,n,i,r){let o,s,l,a,u=t[0],c=i[0],f=0,d=0;c>u==c>-u?(o=u,u=t[++f]):(o=c,c=i[++d]);let w=0;if(f<e&&d<n)for(c>u==c>-u?(s=u+o,l=o-(s-u),u=t[++f]):(s=c+o,l=o-(s-c),c=i[++d]),o=s,l!==0&&(r[w++]=l);f<e&&d<n;)c>u==c>-u?(s=o+u,a=s-o,l=o-(s-a)+(u-a),u=t[++f]):(s=o+c,a=s-o,l=o-(s-a)+(c-a),c=i[++d]),o=s,l!==0&&(r[w++]=l);for(;f<e;)s=o+u,a=s-o,l=o-(s-a)+(u-a),u=t[++f],o=s,l!==0&&(r[w++]=l);for(;d<n;)s=o+c,a=s-o,l=o-(s-a)+(c-a),c=i[++d],o=s,l!==0&&(r[w++]=l);return(o!==0||w===0)&&(r[w++]=o),w}function Gf(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}function Ze(e){return new Float64Array(e)}const Hf=(3+16*Xt)*Xt,qf=(2+12*Xt)*Xt,Uf=(9+64*Xt)*Xt*Xt,ue=Ze(4),ro=Ze(8),oo=Ze(12),so=Ze(16),at=Ze(4);function Xf(e,t,n,i,r,o,s){let l,a,u,c,f,d,w,S,b,P,N,A,L,k,R,D,B,h;const p=e-r,v=n-r,_=t-o,M=i-o;k=p*M,d=ot*p,w=d-(d-p),S=p-w,d=ot*M,b=d-(d-M),P=M-b,R=S*P-(k-w*b-S*b-w*P),D=_*v,d=ot*_,w=d-(d-_),S=_-w,d=ot*v,b=d-(d-v),P=v-b,B=S*P-(D-w*b-S*b-w*P),N=R-B,f=R-N,ue[0]=R-(N+f)+(f-B),A=k+N,f=A-k,L=k-(A-f)+(N-f),N=L-D,f=L-N,ue[1]=L-(N+f)+(f-D),h=A+N,f=h-A,ue[2]=A-(h-f)+(N-f),ue[3]=h;let I=Gf(4,ue),y=qf*s;if(I>=y||-I>=y||(f=e-p,l=e-(p+f)+(f-r),f=n-v,u=n-(v+f)+(f-r),f=t-_,a=t-(_+f)+(f-o),f=i-M,c=i-(M+f)+(f-o),l===0&&a===0&&u===0&&c===0)||(y=Uf*s+Ff*Math.abs(I),I+=p*c+M*l-(_*u+v*a),I>=y||-I>=y))return I;k=l*M,d=ot*l,w=d-(d-l),S=l-w,d=ot*M,b=d-(d-M),P=M-b,R=S*P-(k-w*b-S*b-w*P),D=a*v,d=ot*a,w=d-(d-a),S=a-w,d=ot*v,b=d-(d-v),P=v-b,B=S*P-(D-w*b-S*b-w*P),N=R-B,f=R-N,at[0]=R-(N+f)+(f-B),A=k+N,f=A-k,L=k-(A-f)+(N-f),N=L-D,f=L-N,at[1]=L-(N+f)+(f-D),h=A+N,f=h-A,at[2]=A-(h-f)+(N-f),at[3]=h;const g=pi(4,ue,4,at,ro);k=p*c,d=ot*p,w=d-(d-p),S=p-w,d=ot*c,b=d-(d-c),P=c-b,R=S*P-(k-w*b-S*b-w*P),D=_*u,d=ot*_,w=d-(d-_),S=_-w,d=ot*u,b=d-(d-u),P=u-b,B=S*P-(D-w*b-S*b-w*P),N=R-B,f=R-N,at[0]=R-(N+f)+(f-B),A=k+N,f=A-k,L=k-(A-f)+(N-f),N=L-D,f=L-N,at[1]=L-(N+f)+(f-D),h=A+N,f=h-A,at[2]=A-(h-f)+(N-f),at[3]=h;const m=pi(g,ro,4,at,oo);k=l*c,d=ot*l,w=d-(d-l),S=l-w,d=ot*c,b=d-(d-c),P=c-b,R=S*P-(k-w*b-S*b-w*P),D=a*u,d=ot*a,w=d-(d-a),S=a-w,d=ot*u,b=d-(d-u),P=u-b,B=S*P-(D-w*b-S*b-w*P),N=R-B,f=R-N,at[0]=R-(N+f)+(f-B),A=k+N,f=A-k,L=k-(A-f)+(N-f),N=L-D,f=L-N,at[1]=L-(N+f)+(f-D),h=A+N,f=h-A,at[2]=A-(h-f)+(N-f),at[3]=h;const x=pi(m,oo,4,at,so);return so[x-1]}function cn(e,t,n,i,r,o){const s=(t-o)*(n-r),l=(e-r)*(i-o),a=s-l,u=Math.abs(s+l);return Math.abs(a)>=Hf*u?a:-Xf(e,t,n,i,r,o,u)}const lo=Math.pow(2,-52),fn=new Uint32Array(512);class Ln{static from(t,n=Wf,i=Qf){const r=t.length,o=new Float64Array(r*2);for(let s=0;s<r;s++){const l=t[s];o[2*s]=n(l),o[2*s+1]=i(l)}return new Ln(o)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:o}=this,s=t.length>>1;let l=1/0,a=1/0,u=-1/0,c=-1/0;for(let p=0;p<s;p++){const v=t[2*p],_=t[2*p+1];v<l&&(l=v),_<a&&(a=_),v>u&&(u=v),_>c&&(c=_),this._ids[p]=p}const f=(l+u)/2,d=(a+c)/2;let w,S,b;for(let p=0,v=1/0;p<s;p++){const _=gi(f,d,t[2*p],t[2*p+1]);_<v&&(w=p,v=_)}const P=t[2*w],N=t[2*w+1];for(let p=0,v=1/0;p<s;p++){if(p===w)continue;const _=gi(P,N,t[2*p],t[2*p+1]);_<v&&_>0&&(S=p,v=_)}let A=t[2*S],L=t[2*S+1],k=1/0;for(let p=0;p<s;p++){if(p===w||p===S)continue;const v=Vf(P,N,A,L,t[2*p],t[2*p+1]);v<k&&(b=p,k=v)}let R=t[2*b],D=t[2*b+1];if(k===1/0){for(let _=0;_<s;_++)this._dists[_]=t[2*_]-t[0]||t[2*_+1]-t[1];ge(this._ids,this._dists,0,s-1);const p=new Uint32Array(s);let v=0;for(let _=0,M=-1/0;_<s;_++){const I=this._ids[_],y=this._dists[I];y>M&&(p[v++]=I,M=y)}this.hull=p.subarray(0,v),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(cn(P,N,A,L,R,D)<0){const p=S,v=A,_=L;S=b,A=R,L=D,b=p,R=v,D=_}const B=jf(P,N,A,L,R,D);this._cx=B.x,this._cy=B.y;for(let p=0;p<s;p++)this._dists[p]=gi(t[2*p],t[2*p+1],B.x,B.y);ge(this._ids,this._dists,0,s-1),this._hullStart=w;let h=3;i[w]=n[b]=S,i[S]=n[w]=b,i[b]=n[S]=w,r[w]=0,r[S]=1,r[b]=2,o.fill(-1),o[this._hashKey(P,N)]=w,o[this._hashKey(A,L)]=S,o[this._hashKey(R,D)]=b,this.trianglesLen=0,this._addTriangle(w,S,b,-1,-1,-1);for(let p=0,v,_;p<this._ids.length;p++){const M=this._ids[p],I=t[2*M],y=t[2*M+1];if(p>0&&Math.abs(I-v)<=lo&&Math.abs(y-_)<=lo||(v=I,_=y,M===w||M===S||M===b))continue;let g=0;for(let O=0,C=this._hashKey(I,y);O<this._hashSize&&(g=o[(C+O)%this._hashSize],!(g!==-1&&g!==i[g]));O++);g=n[g];let m=g,x;for(;x=i[m],cn(I,y,t[2*m],t[2*m+1],t[2*x],t[2*x+1])>=0;)if(m=x,m===g){m=-1;break}if(m===-1)continue;let E=this._addTriangle(m,M,i[m],-1,-1,r[m]);r[M]=this._legalize(E+2),r[m]=E,h++;let $=i[m];for(;x=i[$],cn(I,y,t[2*$],t[2*$+1],t[2*x],t[2*x+1])<0;)E=this._addTriangle($,M,x,r[M],-1,r[$]),r[M]=this._legalize(E+2),i[$]=$,h--,$=x;if(m===g)for(;x=n[m],cn(I,y,t[2*x],t[2*x+1],t[2*m],t[2*m+1])<0;)E=this._addTriangle(x,M,m,-1,r[m],r[x]),this._legalize(E+2),r[x]=E,i[m]=m,h--,m=x;this._hullStart=n[M]=m,i[m]=n[$]=M,i[M]=$,o[this._hashKey(I,y)]=M,o[this._hashKey(t[2*m],t[2*m+1])]=m}this.hull=new Uint32Array(h);for(let p=0,v=this._hullStart;p<h;p++)this.hull[p]=v,v=i[v];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(Yf(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let o=0,s=0;for(;;){const l=i[t],a=t-t%3;if(s=a+(t+2)%3,l===-1){if(o===0)break;t=fn[--o];continue}const u=l-l%3,c=a+(t+1)%3,f=u+(l+2)%3,d=n[s],w=n[t],S=n[c],b=n[f];if(Kf(r[2*d],r[2*d+1],r[2*w],r[2*w+1],r[2*S],r[2*S+1],r[2*b],r[2*b+1])){n[t]=b,n[l]=d;const N=i[f];if(N===-1){let L=this._hullStart;do{if(this._hullTri[L]===f){this._hullTri[L]=t;break}L=this._hullPrev[L]}while(L!==this._hullStart)}this._link(t,N),this._link(l,i[s]),this._link(s,f);const A=u+(l+1)%3;o<fn.length&&(fn[o++]=A)}else{if(o===0)break;t=fn[--o]}}return s}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,o,s){const l=this.trianglesLen;return this._triangles[l]=t,this._triangles[l+1]=n,this._triangles[l+2]=i,this._link(l,r),this._link(l+1,o),this._link(l+2,s),this.trianglesLen+=3,l}}function Yf(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function gi(e,t,n,i){const r=e-n,o=t-i;return r*r+o*o}function Kf(e,t,n,i,r,o,s,l){const a=e-s,u=t-l,c=n-s,f=i-l,d=r-s,w=o-l,S=a*a+u*u,b=c*c+f*f,P=d*d+w*w;return a*(f*P-b*w)-u*(c*P-b*d)+S*(c*w-f*d)<0}function Vf(e,t,n,i,r,o){const s=n-e,l=i-t,a=r-e,u=o-t,c=s*s+l*l,f=a*a+u*u,d=.5/(s*u-l*a),w=(u*c-l*f)*d,S=(s*f-a*c)*d;return w*w+S*S}function jf(e,t,n,i,r,o){const s=n-e,l=i-t,a=r-e,u=o-t,c=s*s+l*l,f=a*a+u*u,d=.5/(s*u-l*a),w=e+(u*c-l*f)*d,S=t+(s*f-a*c)*d;return{x:w,y:S}}function ge(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const o=e[r],s=t[o];let l=r-1;for(;l>=n&&t[e[l]]>s;)e[l+1]=e[l--];e[l+1]=o}else{const r=n+i>>1;let o=n+1,s=i;Ne(e,r,o),t[e[n]]>t[e[i]]&&Ne(e,n,i),t[e[o]]>t[e[i]]&&Ne(e,o,i),t[e[n]]>t[e[o]]&&Ne(e,n,o);const l=e[o],a=t[l];for(;;){do o++;while(t[e[o]]<a);do s--;while(t[e[s]]>a);if(s<o)break;Ne(e,o,s)}e[n+1]=e[s],e[s]=l,i-o+1>=s-n?(ge(e,t,o,i),ge(e,t,n,s-1)):(ge(e,t,n,s-1),ge(e,t,o,i))}}function Ne(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function Wf(e){return e[0]}function Qf(e){return e[1]}const ao=1e-6;class ne{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,o=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${o}`:(Math.abs(this._x1-r)>ao||Math.abs(this._y1-o)>ao)&&(this._+="L"+r+","+o),i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=o}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class Di{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class Zf{constructor(t,[n,i,r,o]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((o=+o)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=o,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this;let o,s;const l=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let b=0,P=0,N=i.length,A,L;b<N;b+=3,P+=2){const k=i[b]*2,R=i[b+1]*2,D=i[b+2]*2,B=t[k],h=t[k+1],p=t[R],v=t[R+1],_=t[D],M=t[D+1],I=p-B,y=v-h,g=_-B,m=M-h,x=(I*m-y*g)*2;if(Math.abs(x)<1e-9){if(o===void 0){o=s=0;for(const $ of n)o+=t[$*2],s+=t[$*2+1];o/=n.length,s/=n.length}const E=1e9*Math.sign((o-B)*m-(s-h)*g);A=(B+_)/2-E*m,L=(h+M)/2+E*g}else{const E=1/x,$=I*I+y*y,O=g*g+m*m;A=B+(m*$-y*O)*E,L=h+(I*O-g*$)*E}l[P]=A,l[P+1]=L}let a=n[n.length-1],u,c=a*4,f,d=t[2*a],w,S=t[2*a+1];r.fill(0);for(let b=0;b<n.length;++b)a=n[b],u=c,f=d,w=S,c=a*4,d=t[2*a],S=t[2*a+1],r[u+2]=r[c]=w-S,r[u+3]=r[c+1]=d-f}render(t){const n=t==null?t=new ne:void 0,{delaunay:{halfedges:i,inedges:r,hull:o},circumcenters:s,vectors:l}=this;if(o.length<=1)return null;for(let c=0,f=i.length;c<f;++c){const d=i[c];if(d<c)continue;const w=Math.floor(c/3)*2,S=Math.floor(d/3)*2,b=s[w],P=s[w+1],N=s[S],A=s[S+1];this._renderSegment(b,P,N,A,t)}let a,u=o[o.length-1];for(let c=0;c<o.length;++c){a=u,u=o[c];const f=Math.floor(r[u]/3)*2,d=s[f],w=s[f+1],S=a*4,b=this._project(d,w,l[S+2],l[S+3]);b&&this._renderSegment(d,w,b[0],b[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new ne:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new ne:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let o=r.length;for(;r[0]===r[o-2]&&r[1]===r[o-1]&&o>1;)o-=2;for(let s=2;s<o;s+=2)(r[s]!==r[s-2]||r[s+1]!==r[s-1])&&n.lineTo(r[s],r[s+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new Di;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,o){let s;const l=this._regioncode(t,n),a=this._regioncode(i,r);l===0&&a===0?(o.moveTo(t,n),o.lineTo(i,r)):(s=this._clipSegment(t,n,i,r,l,a))&&(o.moveTo(s[0],s[1]),o.lineTo(s[2],s[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r){t:for(let o=0,s=n.length;o<s;o+=2)for(let l=0,a=r.length;l<a;l+=2)if(n[o]===r[l]&&n[o+1]===r[l+1]&&n[(o+2)%s]===r[(l+a-2)%a]&&n[(o+3)%s]===r[(l+a-1)%a]){yield i;break t}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:o}}=this,s=i[t];if(s===-1)return null;const l=[];let a=s;do{const u=Math.floor(a/3);if(l.push(n[u*2],n[u*2+1]),a=a%3===2?a-2:a+1,o[a]!==t)break;a=r[a]}while(a!==s&&a!==-1);return l}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return this._simplify(i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n))}_clipFinite(t,n){const i=n.length;let r=null,o,s,l=n[i-2],a=n[i-1],u,c=this._regioncode(l,a),f,d=0;for(let w=0;w<i;w+=2)if(o=l,s=a,l=n[w],a=n[w+1],u=c,c=this._regioncode(l,a),u===0&&c===0)f=d,d=0,r?r.push(l,a):r=[l,a];else{let S,b,P,N,A;if(u===0){if((S=this._clipSegment(o,s,l,a,u,c))===null)continue;[b,P,N,A]=S}else{if((S=this._clipSegment(l,a,o,s,c,u))===null)continue;[N,A,b,P]=S,f=d,d=this._edgecode(b,P),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(b,P):r=[b,P]}f=d,d=this._edgecode(N,A),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(N,A):r=[N,A]}if(r)f=d,d=this._edgecode(r[0],r[1]),f&&d&&this._edge(t,f,d,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,o,s){const l=o<s;for(l&&([t,n,i,r,o,s]=[i,r,t,n,s,o]);;){if(o===0&&s===0)return l?[i,r,t,n]:[t,n,i,r];if(o&s)return null;let a,u,c=o||s;c&8?(a=t+(i-t)*(this.ymax-n)/(r-n),u=this.ymax):c&4?(a=t+(i-t)*(this.ymin-n)/(r-n),u=this.ymin):c&2?(u=n+(r-n)*(this.xmax-t)/(i-t),a=this.xmax):(u=n+(r-n)*(this.xmin-t)/(i-t),a=this.xmin),o?(t=a,n=u,o=this._regioncode(t,n)):(i=a,r=u,s=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,o,s){let l=Array.from(n),a;if((a=this._project(l[0],l[1],i,r))&&l.unshift(a[0],a[1]),(a=this._project(l[l.length-2],l[l.length-1],o,s))&&l.push(a[0],a[1]),l=this._clipFinite(t,l))for(let u=0,c=l.length,f,d=this._edgecode(l[c-2],l[c-1]);u<c;u+=2)f=d,d=this._edgecode(l[u],l[u+1]),f&&d&&(u=this._edge(t,f,d,l,u),c=l.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(l=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return l}_edge(t,n,i,r,o){for(;n!==i;){let s,l;switch(n){case 5:n=4;continue;case 4:n=6,s=this.xmax,l=this.ymin;break;case 6:n=2;continue;case 2:n=10,s=this.xmax,l=this.ymax;break;case 10:n=8;continue;case 8:n=9,s=this.xmin,l=this.ymax;break;case 9:n=1;continue;case 1:n=5,s=this.xmin,l=this.ymin;break}(r[o]!==s||r[o+1]!==l)&&this.contains(t,s,l)&&(r.splice(o,0,s,l),o+=2)}return o}_project(t,n,i,r){let o=1/0,s,l,a;if(r<0){if(n<=this.ymin)return null;(s=(this.ymin-n)/r)<o&&(a=this.ymin,l=t+(o=s)*i)}else if(r>0){if(n>=this.ymax)return null;(s=(this.ymax-n)/r)<o&&(a=this.ymax,l=t+(o=s)*i)}if(i>0){if(t>=this.xmax)return null;(s=(this.xmax-t)/i)<o&&(l=this.xmax,a=n+(o=s)*r)}else if(i<0){if(t<=this.xmin)return null;(s=(this.xmin-t)/i)<o&&(l=this.xmin,a=n+(o=s)*r)}return[l,a]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const i=(n+2)%t.length,r=(n+4)%t.length;(t[n]===t[i]&&t[i]===t[r]||t[n+1]===t[i+1]&&t[i+1]===t[r+1])&&(t.splice(i,2),n-=2)}t.length||(t=null)}return t}}const Jf=2*Math.PI,ce=Math.pow;function th(e){return e[0]}function eh(e){return e[1]}function nh(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],o=2*t[i+1],s=2*t[i+2];if((n[s]-n[r])*(n[o+1]-n[r+1])-(n[o]-n[r])*(n[s+1]-n[r+1])>1e-10)return!1}return!0}function ih(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class xr{static from(t,n=th,i=eh,r){return new xr("length"in t?rh(t,n,i,r):Float64Array.from(oh(t,n,i,r)))}constructor(t){this._delaunator=new Ln(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&nh(t)){this.collinear=Int32Array.from({length:n.length/2},(d,w)=>w).sort((d,w)=>n[2*d]-n[2*w]||n[2*d+1]-n[2*w+1]);const a=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[n[2*a],n[2*a+1],n[2*u],n[2*u+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,w=n.length/2;d<w;++d){const S=ih(n[2*d],n[2*d+1],f);n[2*d]=S[0],n[2*d+1]=S[1]}this._delaunator=new Ln(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),l=this._hullIndex.fill(-1);for(let a=0,u=i.length;a<u;++a){const c=o[a%3===2?a-2:a+1];(i[a]===-1||s[c]===-1)&&(s[c]=a)}for(let a=0,u=r.length;a<u;++a)l[r[a]]=a;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],s[r[0]]=1,r.length===2&&(s[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new Zf(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:o,triangles:s,collinear:l}=this;if(l){const f=l.indexOf(t);f>0&&(yield l[f-1]),f<l.length-1&&(yield l[f+1]);return}const a=n[t];if(a===-1)return;let u=a,c=-1;do{if(yield c=s[u],u=u%3===2?u-2:u+1,s[u]!==t)return;if(u=o[u],u===-1){const f=i[(r[t]+1)%i.length];f!==c&&(yield f);return}}while(u!==a)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let o;for(;(o=this._step(i,t,n))>=0&&o!==i&&o!==r;)i=o;return o}_step(t,n,i){const{inedges:r,hull:o,_hullIndex:s,halfedges:l,triangles:a,points:u}=this;if(r[t]===-1||!u.length)return(t+1)%(u.length>>1);let c=t,f=ce(n-u[t*2],2)+ce(i-u[t*2+1],2);const d=r[t];let w=d;do{let S=a[w];const b=ce(n-u[S*2],2)+ce(i-u[S*2+1],2);if(b<f&&(f=b,c=S),w=w%3===2?w-2:w+1,a[w]!==t)break;if(w=l[w],w===-1){if(w=o[(s[t]+1)%o.length],w!==S&&ce(n-u[w*2],2)+ce(i-u[w*2+1],2)<f)return w;break}}while(w!==d);return c}render(t){const n=t==null?t=new ne:void 0,{points:i,halfedges:r,triangles:o}=this;for(let s=0,l=r.length;s<l;++s){const a=r[s];if(a<s)continue;const u=o[s]*2,c=o[a]*2;t.moveTo(i[u],i[u+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const i=t==null?t=new ne:void 0,{points:r}=this;for(let o=0,s=r.length;o<s;o+=2){const l=r[o],a=r[o+1];t.moveTo(l+n,a),t.arc(l,a,n,0,Jf)}return i&&i.value()}renderHull(t){const n=t==null?t=new ne:void 0,{hull:i,points:r}=this,o=i[0]*2,s=i.length;t.moveTo(r[o],r[o+1]);for(let l=1;l<s;++l){const a=2*i[l];t.lineTo(r[a],r[a+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new Di;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new ne:void 0,{points:r,triangles:o}=this,s=o[t*=3]*2,l=o[t+1]*2,a=o[t+2]*2;return n.moveTo(r[s],r[s+1]),n.lineTo(r[l],r[l+1]),n.lineTo(r[a],r[a+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new Di;return this.renderTriangle(t,n),n.value()}}function rh(e,t,n,i){const r=e.length,o=new Float64Array(r*2);for(let s=0;s<r;++s){const l=e[s];o[s*2]=t.call(i,l,s,e),o[s*2+1]=n.call(i,l,s,e)}return o}function*oh(e,t,n,i){let r=0;for(const o of e)yield t.call(i,o,r,e),yield n.call(i,o,r,e),++r}var K=1e-6,Ri=1e-12,V=Math.PI,st=V/2,uo=V/4,vt=V*2,ut=180/V,j=V/180,Q=Math.abs,oi=Math.atan,Kt=Math.atan2,Y=Math.cos,hn=Math.ceil,ks=Math.exp,Ci=Math.hypot,Ps=Math.log,U=Math.sin,sh=Math.sign||function(e){return e>0?1:e<0?-1:0},Ft=Math.sqrt,Ls=Math.tan;function lh(e){return e>1?0:e<-1?V:Math.acos(e)}function Vt(e){return e>1?st:e<-1?-st:Math.asin(e)}function it(){}function On(e,t){e&&fo.hasOwnProperty(e.type)&&fo[e.type](e,t)}var co={Feature:function(e,t){On(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)On(n[i].geometry,t)}},fo={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){Bi(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)Bi(n[i],t,0)},Polygon:function(e,t){ho(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)ho(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)On(n[i],t)}};function Bi(e,t,n){var i=-1,r=e.length-n,o;for(t.lineStart();++i<r;)o=e[i],t.point(o[0],o[1],o[2]);t.lineEnd()}function ho(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)Bi(e[n],t,1);t.polygonEnd()}function Qt(e,t){e&&co.hasOwnProperty(e.type)?co[e.type](e,t):On(e,t)}function zi(e){return[Kt(e[1],e[0]),Vt(e[2])]}function xe(e){var t=e[0],n=e[1],i=Y(n);return[i*Y(t),i*U(t),U(n)]}function dn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Dn(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function mi(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function pn(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Fi(e){var t=Ft(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Pe,Rn,Cn,Bn,zn,Fn,Gn,Hn,Gi,Hi,qi,Os,Ds,ct,ft,ht,$t={sphere:it,point:Sr,lineStart:po,lineEnd:go,polygonStart:function(){$t.lineStart=ch,$t.lineEnd=fh},polygonEnd:function(){$t.lineStart=po,$t.lineEnd=go}};function Sr(e,t){e*=j,t*=j;var n=Y(t);Je(n*Y(e),n*U(e),U(t))}function Je(e,t,n){++Pe,Cn+=(e-Cn)/Pe,Bn+=(t-Bn)/Pe,zn+=(n-zn)/Pe}function po(){$t.point=ah}function ah(e,t){e*=j,t*=j;var n=Y(t);ct=n*Y(e),ft=n*U(e),ht=U(t),$t.point=uh,Je(ct,ft,ht)}function uh(e,t){e*=j,t*=j;var n=Y(t),i=n*Y(e),r=n*U(e),o=U(t),s=Kt(Ft((s=ft*o-ht*r)*s+(s=ht*i-ct*o)*s+(s=ct*r-ft*i)*s),ct*i+ft*r+ht*o);Rn+=s,Fn+=s*(ct+(ct=i)),Gn+=s*(ft+(ft=r)),Hn+=s*(ht+(ht=o)),Je(ct,ft,ht)}function go(){$t.point=Sr}function ch(){$t.point=hh}function fh(){Rs(Os,Ds),$t.point=Sr}function hh(e,t){Os=e,Ds=t,e*=j,t*=j,$t.point=Rs;var n=Y(t);ct=n*Y(e),ft=n*U(e),ht=U(t),Je(ct,ft,ht)}function Rs(e,t){e*=j,t*=j;var n=Y(t),i=n*Y(e),r=n*U(e),o=U(t),s=ft*o-ht*r,l=ht*i-ct*o,a=ct*r-ft*i,u=Ci(s,l,a),c=Vt(u),f=u&&-c/u;Gi.add(f*s),Hi.add(f*l),qi.add(f*a),Rn+=c,Fn+=c*(ct+(ct=i)),Gn+=c*(ft+(ft=r)),Hn+=c*(ht+(ht=o)),Je(ct,ft,ht)}function mo(e){Pe=Rn=Cn=Bn=zn=Fn=Gn=Hn=0,Gi=new Tt,Hi=new Tt,qi=new Tt,Qt(e,$t);var t=+Gi,n=+Hi,i=+qi,r=Ci(t,n,i);return r<Ri&&(t=Fn,n=Gn,i=Hn,Rn<K&&(t=Cn,n=Bn,i=zn),r=Ci(t,n,i),r<Ri)?[NaN,NaN]:[Kt(n,t)*ut,Vt(i/r)*ut]}function Ui(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function Xi(e,t){return Q(e)>V&&(e-=Math.round(e/vt)*vt),[e,t]}Xi.invert=Xi;function Cs(e,t,n){return(e%=vt)?t||n?Ui(wo(e),vo(t,n)):wo(e):t||n?vo(t,n):Xi}function yo(e){return function(t,n){return t+=e,Q(t)>V&&(t-=Math.round(t/vt)*vt),[t,n]}}function wo(e){var t=yo(e);return t.invert=yo(-e),t}function vo(e,t){var n=Y(e),i=U(e),r=Y(t),o=U(t);function s(l,a){var u=Y(a),c=Y(l)*u,f=U(l)*u,d=U(a),w=d*n+c*i;return[Kt(f*r-w*o,c*n-d*i),Vt(w*r+f*o)]}return s.invert=function(l,a){var u=Y(a),c=Y(l)*u,f=U(l)*u,d=U(a),w=d*r-f*o;return[Kt(f*r+d*o,c*n+w*i),Vt(w*n-c*i)]},s}function qn(e){e=Cs(e[0]*j,e[1]*j,e.length>2?e[2]*j:0);function t(n){return n=e(n[0]*j,n[1]*j),n[0]*=ut,n[1]*=ut,n}return t.invert=function(n){return n=e.invert(n[0]*j,n[1]*j),n[0]*=ut,n[1]*=ut,n},t}function dh(e,t,n,i,r,o){if(n){var s=Y(t),l=U(t),a=i*n;r==null?(r=t+i*vt,o=t-a/2):(r=_o(s,r),o=_o(s,o),(i>0?r<o:r>o)&&(r+=i*vt));for(var u,c=r;i>0?c>o:c<o;c-=a)u=zi([s,-l*Y(c),-l*U(c)]),e.point(u[0],u[1])}}function _o(e,t){t=xe(t),t[0]-=e,Fi(t);var n=lh(-t[1]);return((-t[2]<0?-n:n)+vt-K)%vt}function Bs(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:it,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Sn(e,t){return Q(e[0]-t[0])<K&&Q(e[1]-t[1])<K}function gn(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function zs(e,t,n,i,r){var o=[],s=[],l,a;if(e.forEach(function(S){if(!((b=S.length-1)<=0)){var b,P=S[0],N=S[b],A;if(Sn(P,N)){if(!P[2]&&!N[2]){for(r.lineStart(),l=0;l<b;++l)r.point((P=S[l])[0],P[1]);r.lineEnd();return}N[0]+=2*K}o.push(A=new gn(P,S,null,!0)),s.push(A.o=new gn(P,null,A,!1)),o.push(A=new gn(N,S,null,!1)),s.push(A.o=new gn(N,null,A,!0))}}),!!o.length){for(s.sort(t),xo(o),xo(s),l=0,a=s.length;l<a;++l)s[l].e=n=!n;for(var u=o[0],c,f;;){for(var d=u,w=!0;d.v;)if((d=d.n)===u)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(w)for(l=0,a=c.length;l<a;++l)r.point((f=c[l])[0],f[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(w)for(c=d.p.z,l=c.length-1;l>=0;--l)r.point((f=c[l])[0],f[1]);else i(d.x,d.p.x,-1,r);d=d.p}d=d.o,c=d.z,w=!w}while(!d.v);r.lineEnd()}}}function xo(e){if(t=e.length){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function yi(e){return Q(e[0])<=V?e[0]:sh(e[0])*((Q(e[0])+V)%vt-V)}function ph(e,t){var n=yi(t),i=t[1],r=U(i),o=[U(n),-Y(n),0],s=0,l=0,a=new Tt;r===1?i=st+K:r===-1&&(i=-st-K);for(var u=0,c=e.length;u<c;++u)if(d=(f=e[u]).length)for(var f,d,w=f[d-1],S=yi(w),b=w[1]/2+uo,P=U(b),N=Y(b),A=0;A<d;++A,S=k,P=D,N=B,w=L){var L=f[A],k=yi(L),R=L[1]/2+uo,D=U(R),B=Y(R),h=k-S,p=h>=0?1:-1,v=p*h,_=v>V,M=P*D;if(a.add(Kt(M*p*U(v),N*B+M*Y(v))),s+=_?h+p*vt:h,_^S>=n^k>=n){var I=Dn(xe(w),xe(L));Fi(I);var y=Dn(o,I);Fi(y);var g=(_^h>=0?-1:1)*Vt(y[2]);(i>g||i===g&&(I[0]||I[1]))&&(l+=_^h>=0?1:-1)}}return(s<-K||s<K&&a<-Ri)^l&1}function Fs(e,t,n,i){return function(r){var o=t(r),s=Bs(),l=t(s),a=!1,u,c,f,d={point:w,lineStart:b,lineEnd:P,polygonStart:function(){d.point=N,d.lineStart=A,d.lineEnd=L,c=[],u=[]},polygonEnd:function(){d.point=w,d.lineStart=b,d.lineEnd=P,c=ns(c);var k=ph(u,i);c.length?(a||(r.polygonStart(),a=!0),zs(c,mh,k,n,r)):k&&(a||(r.polygonStart(),a=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),a&&(r.polygonEnd(),a=!1),c=u=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function w(k,R){e(k,R)&&r.point(k,R)}function S(k,R){o.point(k,R)}function b(){d.point=S,o.lineStart()}function P(){d.point=w,o.lineEnd()}function N(k,R){f.push([k,R]),l.point(k,R)}function A(){l.lineStart(),f=[]}function L(){N(f[0][0],f[0][1]),l.lineEnd();var k=l.clean(),R=s.result(),D,B=R.length,h,p,v;if(f.pop(),u.push(f),f=null,!!B){if(k&1){if(p=R[0],(h=p.length-1)>0){for(a||(r.polygonStart(),a=!0),r.lineStart(),D=0;D<h;++D)r.point((v=p[D])[0],v[1]);r.lineEnd()}return}B>1&&k&2&&R.push(R.pop().concat(R.shift())),c.push(R.filter(gh))}}return d}}function gh(e){return e.length>1}function mh(e,t){return((e=e.x)[0]<0?e[1]-st-K:st-e[1])-((t=t.x)[0]<0?t[1]-st-K:st-t[1])}const So=Fs(function(){return!0},yh,vh,[-V,-st]);function yh(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(o,s){var l=o>0?V:-V,a=Q(o-t);Q(a-V)<K?(e.point(t,n=(n+s)/2>0?st:-st),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(l,n),e.point(o,n),r=0):i!==l&&a>=V&&(Q(t-i)<K&&(t-=i*K),Q(o-l)<K&&(o-=l*K),n=wh(t,n,o,s),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(l,n),r=0),e.point(t=o,n=s),i=l},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function wh(e,t,n,i){var r,o,s=U(e-n);return Q(s)>K?oi((U(t)*(o=Y(i))*U(n)-U(i)*(r=Y(t))*U(e))/(r*o*s)):(t+i)/2}function vh(e,t,n,i){var r;if(e==null)r=n*st,i.point(-V,r),i.point(0,r),i.point(V,r),i.point(V,0),i.point(V,-r),i.point(0,-r),i.point(-V,-r),i.point(-V,0),i.point(-V,r);else if(Q(e[0]-t[0])>K){var o=e[0]<t[0]?V:-V;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(t[0],t[1])}function _h(e){var t=Y(e),n=2*j,i=t>0,r=Q(t)>K;function o(c,f,d,w){dh(w,e,n,d,c,f)}function s(c,f){return Y(c)*Y(f)>t}function l(c){var f,d,w,S,b;return{lineStart:function(){S=w=!1,b=1},point:function(P,N){var A=[P,N],L,k=s(P,N),R=i?k?0:u(P,N):k?u(P+(P<0?V:-V),N):0;if(!f&&(S=w=k)&&c.lineStart(),k!==w&&(L=a(f,A),(!L||Sn(f,L)||Sn(A,L))&&(A[2]=1)),k!==w)b=0,k?(c.lineStart(),L=a(A,f),c.point(L[0],L[1])):(L=a(f,A),c.point(L[0],L[1],2),c.lineEnd()),f=L;else if(r&&f&&i^k){var D;!(R&d)&&(D=a(A,f,!0))&&(b=0,i?(c.lineStart(),c.point(D[0][0],D[0][1]),c.point(D[1][0],D[1][1]),c.lineEnd()):(c.point(D[1][0],D[1][1]),c.lineEnd(),c.lineStart(),c.point(D[0][0],D[0][1],3)))}k&&(!f||!Sn(f,A))&&c.point(A[0],A[1]),f=A,w=k,d=R},lineEnd:function(){w&&c.lineEnd(),f=null},clean:function(){return b|(S&&w)<<1}}}function a(c,f,d){var w=xe(c),S=xe(f),b=[1,0,0],P=Dn(w,S),N=dn(P,P),A=P[0],L=N-A*A;if(!L)return!d&&c;var k=t*N/L,R=-t*A/L,D=Dn(b,P),B=pn(b,k),h=pn(P,R);mi(B,h);var p=D,v=dn(B,p),_=dn(p,p),M=v*v-_*(dn(B,B)-1);if(!(M<0)){var I=Ft(M),y=pn(p,(-v-I)/_);if(mi(y,B),y=zi(y),!d)return y;var g=c[0],m=f[0],x=c[1],E=f[1],$;m<g&&($=g,g=m,m=$);var O=m-g,C=Q(O-V)<K,z=C||O<K;if(!C&&E<x&&($=x,x=E,E=$),z?C?x+E>0^y[1]<(Q(y[0]-g)<K?x:E):x<=y[1]&&y[1]<=E:O>V^(g<=y[0]&&y[0]<=m)){var G=pn(p,(-v+I)/_);return mi(G,B),[y,zi(G)]}}}function u(c,f){var d=i?e:V-e,w=0;return c<-d?w|=1:c>d&&(w|=2),f<-d?w|=4:f>d&&(w|=8),w}return Fs(s,l,o,i?[0,-e]:[-V,e-V])}function xh(e,t,n,i,r,o){var s=e[0],l=e[1],a=t[0],u=t[1],c=0,f=1,d=a-s,w=u-l,S;if(S=n-s,!(!d&&S>0)){if(S/=d,d<0){if(S<c)return;S<f&&(f=S)}else if(d>0){if(S>f)return;S>c&&(c=S)}if(S=r-s,!(!d&&S<0)){if(S/=d,d<0){if(S>f)return;S>c&&(c=S)}else if(d>0){if(S<c)return;S<f&&(f=S)}if(S=i-l,!(!w&&S>0)){if(S/=w,w<0){if(S<c)return;S<f&&(f=S)}else if(w>0){if(S>f)return;S>c&&(c=S)}if(S=o-l,!(!w&&S<0)){if(S/=w,w<0){if(S>f)return;S>c&&(c=S)}else if(w>0){if(S<c)return;S<f&&(f=S)}return c>0&&(e[0]=s+c*d,e[1]=l+c*w),f<1&&(t[0]=s+f*d,t[1]=l+f*w),!0}}}}}var Le=1e9,mn=-Le;function Sh(e,t,n,i){function r(u,c){return e<=u&&u<=n&&t<=c&&c<=i}function o(u,c,f,d){var w=0,S=0;if(u==null||(w=s(u,f))!==(S=s(c,f))||a(u,c)<0^f>0)do d.point(w===0||w===3?e:n,w>1?i:t);while((w=(w+f+4)%4)!==S);else d.point(c[0],c[1])}function s(u,c){return Q(u[0]-e)<K?c>0?0:3:Q(u[0]-n)<K?c>0?2:1:Q(u[1]-t)<K?c>0?1:0:c>0?3:2}function l(u,c){return a(u.x,c.x)}function a(u,c){var f=s(u,1),d=s(c,1);return f!==d?f-d:f===0?c[1]-u[1]:f===1?u[0]-c[0]:f===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,f=Bs(),d,w,S,b,P,N,A,L,k,R,D,B={point:h,lineStart:M,lineEnd:I,polygonStart:v,polygonEnd:_};function h(g,m){r(g,m)&&c.point(g,m)}function p(){for(var g=0,m=0,x=w.length;m<x;++m)for(var E=w[m],$=1,O=E.length,C=E[0],z,G,q=C[0],F=C[1];$<O;++$)z=q,G=F,C=E[$],q=C[0],F=C[1],G<=i?F>i&&(q-z)*(i-G)>(F-G)*(e-z)&&++g:F<=i&&(q-z)*(i-G)<(F-G)*(e-z)&&--g;return g}function v(){c=f,d=[],w=[],D=!0}function _(){var g=p(),m=D&&g,x=(d=ns(d)).length;(m||x)&&(u.polygonStart(),m&&(u.lineStart(),o(null,null,1,u),u.lineEnd()),x&&zs(d,l,g,o,u),u.polygonEnd()),c=u,d=w=S=null}function M(){B.point=y,w&&w.push(S=[]),R=!0,k=!1,A=L=NaN}function I(){d&&(y(b,P),N&&k&&f.rejoin(),d.push(f.result())),B.point=h,k&&c.lineEnd()}function y(g,m){var x=r(g,m);if(w&&S.push([g,m]),R)b=g,P=m,N=x,R=!1,x&&(c.lineStart(),c.point(g,m));else if(x&&k)c.point(g,m);else{var E=[A=Math.max(mn,Math.min(Le,A)),L=Math.max(mn,Math.min(Le,L))],$=[g=Math.max(mn,Math.min(Le,g)),m=Math.max(mn,Math.min(Le,m))];xh(E,$,e,t,n,i)?(k||(c.lineStart(),c.point(E[0],E[1])),c.point($[0],$[1]),x||c.lineEnd(),D=!1):x&&(c.lineStart(),c.point(g,m),D=!1)}A=g,L=m,k=x}return B}}var Yi,Ki,Mn,En,Se={sphere:it,point:it,lineStart:Mh,lineEnd:it,polygonStart:it,polygonEnd:it};function Mh(){Se.point=Ih,Se.lineEnd=Eh}function Eh(){Se.point=Se.lineEnd=it}function Ih(e,t){e*=j,t*=j,Ki=e,Mn=U(t),En=Y(t),Se.point=Ah}function Ah(e,t){e*=j,t*=j;var n=U(t),i=Y(t),r=Q(e-Ki),o=Y(r),s=U(r),l=i*s,a=En*n-Mn*i*o,u=Mn*n+En*i*o;Yi.add(Kt(Ft(l*l+a*a),u)),Ki=e,Mn=n,En=i}function bh(e){return Yi=new Tt,Qt(e,Se),+Yi}var Vi=[null,null],Nh={type:"LineString",coordinates:Vi};function Un(e,t){return Vi[0]=e,Vi[1]=t,bh(Nh)}function Mo(e,t,n){var i=pe(e,t-K,n).concat(t);return function(r){return i.map(function(o){return[r,o]})}}function Eo(e,t,n){var i=pe(e,t-K,n).concat(t);return function(r){return i.map(function(o){return[o,r]})}}function $h(){var e,t,n,i,r,o,s,l,a=10,u=a,c=90,f=360,d,w,S,b,P=2.5;function N(){return{type:"MultiLineString",coordinates:A()}}function A(){return pe(hn(i/c)*c,n,c).map(S).concat(pe(hn(l/f)*f,s,f).map(b)).concat(pe(hn(t/a)*a,e,a).filter(function(L){return Q(L%c)>K}).map(d)).concat(pe(hn(o/u)*u,r,u).filter(function(L){return Q(L%f)>K}).map(w))}return N.lines=function(){return A().map(function(L){return{type:"LineString",coordinates:L}})},N.outline=function(){return{type:"Polygon",coordinates:[S(i).concat(b(s).slice(1),S(n).reverse().slice(1),b(l).reverse().slice(1))]}},N.extent=function(L){return arguments.length?N.extentMajor(L).extentMinor(L):N.extentMinor()},N.extentMajor=function(L){return arguments.length?(i=+L[0][0],n=+L[1][0],l=+L[0][1],s=+L[1][1],i>n&&(L=i,i=n,n=L),l>s&&(L=l,l=s,s=L),N.precision(P)):[[i,l],[n,s]]},N.extentMinor=function(L){return arguments.length?(t=+L[0][0],e=+L[1][0],o=+L[0][1],r=+L[1][1],t>e&&(L=t,t=e,e=L),o>r&&(L=o,o=r,r=L),N.precision(P)):[[t,o],[e,r]]},N.step=function(L){return arguments.length?N.stepMajor(L).stepMinor(L):N.stepMinor()},N.stepMajor=function(L){return arguments.length?(c=+L[0],f=+L[1],N):[c,f]},N.stepMinor=function(L){return arguments.length?(a=+L[0],u=+L[1],N):[a,u]},N.precision=function(L){return arguments.length?(P=+L,d=Mo(o,r,90),w=Eo(t,e,P),S=Mo(l,s,90),b=Eo(i,n,P),N):P},N.extentMajor([[-180,-90+K],[180,90-K]]).extentMinor([[-180,-80-K],[180,80+K]])}const ji=e=>e;var wi=new Tt,Wi=new Tt,Gs,Hs,Qi,Zi,qt={point:it,lineStart:it,lineEnd:it,polygonStart:function(){qt.lineStart=Th,qt.lineEnd=Ph},polygonEnd:function(){qt.lineStart=qt.lineEnd=qt.point=it,wi.add(Q(Wi)),Wi=new Tt},result:function(){var e=wi/2;return wi=new Tt,e}};function Th(){qt.point=kh}function kh(e,t){qt.point=qs,Gs=Qi=e,Hs=Zi=t}function qs(e,t){Wi.add(Zi*e-Qi*t),Qi=e,Zi=t}function Ph(){qs(Gs,Hs)}var Me=1/0,Xn=Me,Xe=-Me,Yn=Xe,Kn={point:Lh,lineStart:it,lineEnd:it,polygonStart:it,polygonEnd:it,result:function(){var e=[[Me,Xn],[Xe,Yn]];return Xe=Yn=-(Xn=Me=1/0),e}};function Lh(e,t){e<Me&&(Me=e),e>Xe&&(Xe=e),t<Xn&&(Xn=t),t>Yn&&(Yn=t)}var Ji=0,tr=0,Oe=0,Vn=0,jn=0,me=0,er=0,nr=0,De=0,Us,Xs,Ot,Dt,It={point:ae,lineStart:Io,lineEnd:Ao,polygonStart:function(){It.lineStart=Rh,It.lineEnd=Ch},polygonEnd:function(){It.point=ae,It.lineStart=Io,It.lineEnd=Ao},result:function(){var e=De?[er/De,nr/De]:me?[Vn/me,jn/me]:Oe?[Ji/Oe,tr/Oe]:[NaN,NaN];return Ji=tr=Oe=Vn=jn=me=er=nr=De=0,e}};function ae(e,t){Ji+=e,tr+=t,++Oe}function Io(){It.point=Oh}function Oh(e,t){It.point=Dh,ae(Ot=e,Dt=t)}function Dh(e,t){var n=e-Ot,i=t-Dt,r=Ft(n*n+i*i);Vn+=r*(Ot+e)/2,jn+=r*(Dt+t)/2,me+=r,ae(Ot=e,Dt=t)}function Ao(){It.point=ae}function Rh(){It.point=Bh}function Ch(){Ys(Us,Xs)}function Bh(e,t){It.point=Ys,ae(Us=Ot=e,Xs=Dt=t)}function Ys(e,t){var n=e-Ot,i=t-Dt,r=Ft(n*n+i*i);Vn+=r*(Ot+e)/2,jn+=r*(Dt+t)/2,me+=r,r=Dt*e-Ot*t,er+=r*(Ot+e),nr+=r*(Dt+t),De+=r*3,ae(Ot=e,Dt=t)}function Ks(e){this._context=e}Ks.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,vt);break}}},result:it};var ir=new Tt,vi,Vs,js,Re,Ce,Ye={point:it,lineStart:function(){Ye.point=zh},lineEnd:function(){vi&&Ws(Vs,js),Ye.point=it},polygonStart:function(){vi=!0},polygonEnd:function(){vi=null},result:function(){var e=+ir;return ir=new Tt,e}};function zh(e,t){Ye.point=Ws,Vs=Re=e,js=Ce=t}function Ws(e,t){Re-=e,Ce-=t,ir.add(Ft(Re*Re+Ce*Ce)),Re=e,Ce=t}let bo,Wn,No,$o;class To{constructor(t){this._append=t==null?Qs:Fh(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==No||this._append!==Wn){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,No=i,Wn=this._append,$o=this._,this._=r}this._+=$o;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Qs(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Fh(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return Qs;if(t!==bo){const n=10**t;bo=t,Wn=function(r){let o=1;this._+=r[0];for(const s=r.length;o<s;++o)this._+=Math.round(arguments[o]*n)/n+r[o]}}return Wn}function Zs(e,t){let n=3,i=4.5,r,o;function s(l){return l&&(typeof i=="function"&&o.pointRadius(+i.apply(this,arguments)),Qt(l,r(o))),o.result()}return s.area=function(l){return Qt(l,r(qt)),qt.result()},s.measure=function(l){return Qt(l,r(Ye)),Ye.result()},s.bounds=function(l){return Qt(l,r(Kn)),Kn.result()},s.centroid=function(l){return Qt(l,r(It)),It.result()},s.projection=function(l){return arguments.length?(r=l==null?(e=null,ji):(e=l).stream,s):e},s.context=function(l){return arguments.length?(o=l==null?(t=null,new To(n)):new Ks(t=l),typeof i!="function"&&o.pointRadius(i),s):t},s.pointRadius=function(l){return arguments.length?(i=typeof l=="function"?l:(o.pointRadius(+l),+l),s):i},s.digits=function(l){if(!arguments.length)return n;if(l==null)n=null;else{const a=Math.floor(l);if(!(a>=0))throw new RangeError(`invalid digits: ${l}`);n=a}return t===null&&(o=new To(n)),s},s.projection(e).digits(n).context(t)}function Mr(e){return function(t){var n=new rr;for(var i in e)n[i]=e[i];return n.stream=t,n}}function rr(){}rr.prototype={constructor:rr,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Er(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),Qt(n,e.stream(Kn)),t(Kn.result()),i!=null&&e.clipExtent(i),e}function Js(e,t,n){return Er(e,function(i){var r=t[1][0]-t[0][0],o=t[1][1]-t[0][1],s=Math.min(r/(i[1][0]-i[0][0]),o/(i[1][1]-i[0][1])),l=+t[0][0]+(r-s*(i[1][0]+i[0][0]))/2,a=+t[0][1]+(o-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([l,a])},n)}function Gh(e,t,n){return Js(e,[[0,0],t],n)}function Hh(e,t,n){return Er(e,function(i){var r=+t,o=r/(i[1][0]-i[0][0]),s=(r-o*(i[1][0]+i[0][0]))/2,l=-o*i[0][1];e.scale(150*o).translate([s,l])},n)}function qh(e,t,n){return Er(e,function(i){var r=+t,o=r/(i[1][1]-i[0][1]),s=-o*i[0][0],l=(r-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([s,l])},n)}var ko=16,Uh=Y(30*j);function Po(e,t){return+t?Yh(e,t):Xh(e)}function Xh(e){return Mr({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Yh(e,t){function n(i,r,o,s,l,a,u,c,f,d,w,S,b,P){var N=u-i,A=c-r,L=N*N+A*A;if(L>4*t&&b--){var k=s+d,R=l+w,D=a+S,B=Ft(k*k+R*R+D*D),h=Vt(D/=B),p=Q(Q(D)-1)<K||Q(o-f)<K?(o+f)/2:Kt(R,k),v=e(p,h),_=v[0],M=v[1],I=_-i,y=M-r,g=A*I-N*y;(g*g/L>t||Q((N*I+A*y)/L-.5)>.3||s*d+l*w+a*S<Uh)&&(n(i,r,o,s,l,a,_,M,p,k/=B,R/=B,D,b,P),P.point(_,M),n(_,M,p,k,R,D,u,c,f,d,w,S,b,P))}}return function(i){var r,o,s,l,a,u,c,f,d,w,S,b,P={point:N,lineStart:A,lineEnd:k,polygonStart:function(){i.polygonStart(),P.lineStart=R},polygonEnd:function(){i.polygonEnd(),P.lineStart=A}};function N(h,p){h=e(h,p),i.point(h[0],h[1])}function A(){f=NaN,P.point=L,i.lineStart()}function L(h,p){var v=xe([h,p]),_=e(h,p);n(f,d,c,w,S,b,f=_[0],d=_[1],c=h,w=v[0],S=v[1],b=v[2],ko,i),i.point(f,d)}function k(){P.point=N,i.lineEnd()}function R(){A(),P.point=D,P.lineEnd=B}function D(h,p){L(r=h,p),o=f,s=d,l=w,a=S,u=b,P.point=L}function B(){n(f,d,c,w,S,b,o,s,r,l,a,u,ko,i),P.lineEnd=k,k()}return P}}var Kh=Mr({point:function(e,t){this.stream.point(e*j,t*j)}});function Vh(e){return Mr({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function jh(e,t,n,i,r){function o(s,l){return s*=i,l*=r,[t+e*s,n-e*l]}return o.invert=function(s,l){return[(s-t)/e*i,(n-l)/e*r]},o}function Lo(e,t,n,i,r,o){if(!o)return jh(e,t,n,i,r);var s=Y(o),l=U(o),a=s*e,u=l*e,c=s/e,f=l/e,d=(l*n-s*t)/e,w=(l*t+s*n)/e;function S(b,P){return b*=i,P*=r,[a*b-u*P+t,n-u*b-a*P]}return S.invert=function(b,P){return[i*(c*b-f*P+d),r*(w-f*b-c*P)]},S}function Ir(e){return Wh(function(){return e})()}function Wh(e){var t,n=150,i=480,r=250,o=0,s=0,l=0,a=0,u=0,c,f=0,d=1,w=1,S=null,b=So,P=null,N,A,L,k=ji,R=.5,D,B,h,p,v;function _(g){return h(g[0]*j,g[1]*j)}function M(g){return g=h.invert(g[0],g[1]),g&&[g[0]*ut,g[1]*ut]}_.stream=function(g){return p&&v===g?p:p=Kh(Vh(c)(b(D(k(v=g)))))},_.preclip=function(g){return arguments.length?(b=g,S=void 0,y()):b},_.postclip=function(g){return arguments.length?(k=g,P=N=A=L=null,y()):k},_.clipAngle=function(g){return arguments.length?(b=+g?_h(S=g*j):(S=null,So),y()):S*ut},_.clipExtent=function(g){return arguments.length?(k=g==null?(P=N=A=L=null,ji):Sh(P=+g[0][0],N=+g[0][1],A=+g[1][0],L=+g[1][1]),y()):P==null?null:[[P,N],[A,L]]},_.scale=function(g){return arguments.length?(n=+g,I()):n},_.translate=function(g){return arguments.length?(i=+g[0],r=+g[1],I()):[i,r]},_.center=function(g){return arguments.length?(o=g[0]%360*j,s=g[1]%360*j,I()):[o*ut,s*ut]},_.rotate=function(g){return arguments.length?(l=g[0]%360*j,a=g[1]%360*j,u=g.length>2?g[2]%360*j:0,I()):[l*ut,a*ut,u*ut]},_.angle=function(g){return arguments.length?(f=g%360*j,I()):f*ut},_.reflectX=function(g){return arguments.length?(d=g?-1:1,I()):d<0},_.reflectY=function(g){return arguments.length?(w=g?-1:1,I()):w<0},_.precision=function(g){return arguments.length?(D=Po(B,R=g*g),y()):Ft(R)},_.fitExtent=function(g,m){return Js(_,g,m)},_.fitSize=function(g,m){return Gh(_,g,m)},_.fitWidth=function(g,m){return Hh(_,g,m)},_.fitHeight=function(g,m){return qh(_,g,m)};function I(){var g=Lo(n,0,0,d,w,f).apply(null,t(o,s)),m=Lo(n,i-g[0],r-g[1],d,w,f);return c=Cs(l,a,u),B=Ui(t,m),h=Ui(c,B),D=Po(B,R),y()}function y(){return p=v=null,_}return function(){return t=e.apply(this,arguments),_.invert=t.invert&&M,I()}}function tl(e){return function(t,n){var i=Ft(t*t+n*n),r=e(i),o=U(r),s=Y(r);return[Kt(t*o,i*s),Vt(i&&n*o/i)]}}function Ar(e,t){return[e,Ps(Ls((st+t)/2))]}Ar.invert=function(e,t){return[e,2*oi(ks(t))-st]};function Qh(){return el(Ar).scale(961/vt)}function el(e){var t=Ir(e),n=t.center,i=t.scale,r=t.translate,o=t.clipExtent,s=null,l,a,u;t.scale=function(f){return arguments.length?(i(f),c()):i()},t.translate=function(f){return arguments.length?(r(f),c()):r()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?s=l=a=u=null:(s=+f[0][0],l=+f[0][1],a=+f[1][0],u=+f[1][1]),c()):s==null?null:[[s,l],[a,u]]};function c(){var f=V*i(),d=t(qn(t.rotate()).invert([0,0]));return o(s==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===Ar?[[Math.max(d[0]-f,s),l],[Math.min(d[0]+f,a),u]]:[[s,Math.max(d[1]-f,l)],[a,Math.min(d[1]+f,u)]])}return c()}function nl(e,t){return[Y(t)*U(e),U(t)]}nl.invert=tl(Vt);function Zh(){return Ir(nl).scale(249.5).clipAngle(90+K)}function il(e,t){var n=Y(t),i=1+Y(e)*n;return[n*U(e)/i,U(t)/i]}il.invert=tl(function(e){return 2*oi(e)});function rl(){return Ir(il).scale(250).clipAngle(142)}function ol(e,t){return[Ps(Ls((st+t)/2)),-e]}ol.invert=function(e,t){return[-t,2*oi(ks(e))-st]};function Jh(){var e=el(ol),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}const yn=e=>()=>e;function t0(e,{sourceEvent:t,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function Ut(e,t,n){this.k=e,this.x=t,this.y=n}Ut.prototype={constructor:Ut,scale:function(e){return e===1?this:new Ut(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ut(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var sl=new Ut(1,0,0);Ut.prototype;function _i(e){e.stopImmediatePropagation()}function $e(e){e.preventDefault(),e.stopImmediatePropagation()}function e0(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function n0(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Oo(){return this.__zoom||sl}function i0(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function r0(){return navigator.maxTouchPoints||"ontouchstart"in this}function o0(e,t,n){var i=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function s0(){var e=e0,t=n0,n=o0,i=i0,r=r0,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],l=250,a=bc,u=ei("start","zoom","end"),c,f,d,w=500,S=150,b=0,P=10;function N(y){y.property("__zoom",Oo).on("wheel.zoom",h,{passive:!1}).on("mousedown.zoom",p).on("dblclick.zoom",v).filter(r).on("touchstart.zoom",_).on("touchmove.zoom",M).on("touchend.zoom touchcancel.zoom",I).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}N.transform=function(y,g,m,x){var E=y.selection?y.selection():y;E.property("__zoom",Oo),y!==E?R(y,g,m,x):E.interrupt().each(function(){D(this,arguments).event(x).start().zoom(null,typeof g=="function"?g.apply(this,arguments):g).end()})},N.scaleBy=function(y,g,m,x){N.scaleTo(y,function(){var E=this.__zoom.k,$=typeof g=="function"?g.apply(this,arguments):g;return E*$},m,x)},N.scaleTo=function(y,g,m,x){N.transform(y,function(){var E=t.apply(this,arguments),$=this.__zoom,O=m==null?k(E):typeof m=="function"?m.apply(this,arguments):m,C=$.invert(O),z=typeof g=="function"?g.apply(this,arguments):g;return n(L(A($,z),O,C),E,s)},m,x)},N.translateBy=function(y,g,m,x){N.transform(y,function(){return n(this.__zoom.translate(typeof g=="function"?g.apply(this,arguments):g,typeof m=="function"?m.apply(this,arguments):m),t.apply(this,arguments),s)},null,x)},N.translateTo=function(y,g,m,x,E){N.transform(y,function(){var $=t.apply(this,arguments),O=this.__zoom,C=x==null?k($):typeof x=="function"?x.apply(this,arguments):x;return n(sl.translate(C[0],C[1]).scale(O.k).translate(typeof g=="function"?-g.apply(this,arguments):-g,typeof m=="function"?-m.apply(this,arguments):-m),$,s)},x,E)};function A(y,g){return g=Math.max(o[0],Math.min(o[1],g)),g===y.k?y:new Ut(g,y.x,y.y)}function L(y,g,m){var x=g[0]-m[0]*y.k,E=g[1]-m[1]*y.k;return x===y.x&&E===y.y?y:new Ut(y.k,x,E)}function k(y){return[(+y[0][0]+ +y[1][0])/2,(+y[0][1]+ +y[1][1])/2]}function R(y,g,m,x){y.on("start.zoom",function(){D(this,arguments).event(x).start()}).on("interrupt.zoom end.zoom",function(){D(this,arguments).event(x).end()}).tween("zoom",function(){var E=this,$=arguments,O=D(E,$).event(x),C=t.apply(E,$),z=m==null?k(C):typeof m=="function"?m.apply(E,$):m,G=Math.max(C[1][0]-C[0][0],C[1][1]-C[0][1]),q=E.__zoom,F=typeof g=="function"?g.apply(E,$):g,X=a(q.invert(z).concat(G/q.k),F.invert(z).concat(G/F.k));return function(W){if(W===1)W=F;else{var dt=X(W),Jt=G/dt[2];W=new Ut(Jt,z[0]-dt[0]*Jt,z[1]-dt[1]*Jt)}O.zoom(null,W)}})}function D(y,g,m){return!m&&y.__zooming||new B(y,g)}function B(y,g){this.that=y,this.args=g,this.active=0,this.sourceEvent=null,this.extent=t.apply(y,g),this.taps=0}B.prototype={event:function(y){return y&&(this.sourceEvent=y),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(y,g){return this.mouse&&y!=="mouse"&&(this.mouse[1]=g.invert(this.mouse[0])),this.touch0&&y!=="touch"&&(this.touch0[1]=g.invert(this.touch0[0])),this.touch1&&y!=="touch"&&(this.touch1[1]=g.invert(this.touch1[0])),this.that.__zoom=g,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(y){var g=et(this.that).datum();u.call(y,this.that,new t0(y,{sourceEvent:this.sourceEvent,target:N,transform:this.that.__zoom,dispatch:u}),g)}};function h(y,...g){if(!e.apply(this,arguments))return;var m=D(this,g).event(y),x=this.__zoom,E=Math.max(o[0],Math.min(o[1],x.k*Math.pow(2,i.apply(this,arguments)))),$=Lt(y);if(m.wheel)(m.mouse[0][0]!==$[0]||m.mouse[0][1]!==$[1])&&(m.mouse[1]=x.invert(m.mouse[0]=$)),clearTimeout(m.wheel);else{if(x.k===E)return;m.mouse=[$,x.invert($)],xn(this),m.start()}$e(y),m.wheel=setTimeout(O,S),m.zoom("mouse",n(L(A(x,E),m.mouse[0],m.mouse[1]),m.extent,s));function O(){m.wheel=null,m.end()}}function p(y,...g){if(d||!e.apply(this,arguments))return;var m=y.currentTarget,x=D(this,g,!0).event(y),E=et(y.view).on("mousemove.zoom",z,!0).on("mouseup.zoom",G,!0),$=Lt(y,m),O=y.clientX,C=y.clientY;ms(y.view),_i(y),x.mouse=[$,this.__zoom.invert($)],xn(this),x.start();function z(q){if($e(q),!x.moved){var F=q.clientX-O,X=q.clientY-C;x.moved=F*F+X*X>b}x.event(q).zoom("mouse",n(L(x.that.__zoom,x.mouse[0]=Lt(q,m),x.mouse[1]),x.extent,s))}function G(q){E.on("mousemove.zoom mouseup.zoom",null),ys(q.view,x.moved),$e(q),x.event(q).end()}}function v(y,...g){if(e.apply(this,arguments)){var m=this.__zoom,x=Lt(y.changedTouches?y.changedTouches[0]:y,this),E=m.invert(x),$=m.k*(y.shiftKey?.5:2),O=n(L(A(m,$),x,E),t.apply(this,g),s);$e(y),l>0?et(this).transition().duration(l).call(R,O,x,y):et(this).call(N.transform,O,x,y)}}function _(y,...g){if(e.apply(this,arguments)){var m=y.touches,x=m.length,E=D(this,g,y.changedTouches.length===x).event(y),$,O,C,z;for(_i(y),O=0;O<x;++O)C=m[O],z=Lt(C,this),z=[z,this.__zoom.invert(z),C.identifier],E.touch0?!E.touch1&&E.touch0[2]!==z[2]&&(E.touch1=z,E.taps=0):(E.touch0=z,$=!0,E.taps=1+!!c);c&&(c=clearTimeout(c)),$&&(E.taps<2&&(f=z[0],c=setTimeout(function(){c=null},w)),xn(this),E.start())}}function M(y,...g){if(this.__zooming){var m=D(this,g).event(y),x=y.changedTouches,E=x.length,$,O,C,z;for($e(y),$=0;$<E;++$)O=x[$],C=Lt(O,this),m.touch0&&m.touch0[2]===O.identifier?m.touch0[0]=C:m.touch1&&m.touch1[2]===O.identifier&&(m.touch1[0]=C);if(O=m.that.__zoom,m.touch1){var G=m.touch0[0],q=m.touch0[1],F=m.touch1[0],X=m.touch1[1],W=(W=F[0]-G[0])*W+(W=F[1]-G[1])*W,dt=(dt=X[0]-q[0])*dt+(dt=X[1]-q[1])*dt;O=A(O,Math.sqrt(W/dt)),C=[(G[0]+F[0])/2,(G[1]+F[1])/2],z=[(q[0]+X[0])/2,(q[1]+X[1])/2]}else if(m.touch0)C=m.touch0[0],z=m.touch0[1];else return;m.zoom("touch",n(L(O,C,z),m.extent,s))}}function I(y,...g){if(this.__zooming){var m=D(this,g).event(y),x=y.changedTouches,E=x.length,$,O;for(_i(y),d&&clearTimeout(d),d=setTimeout(function(){d=null},w),$=0;$<E;++$)O=x[$],m.touch0&&m.touch0[2]===O.identifier?delete m.touch0:m.touch1&&m.touch1[2]===O.identifier&&delete m.touch1;if(m.touch1&&!m.touch0&&(m.touch0=m.touch1,delete m.touch1),m.touch0)m.touch0[1]=this.__zoom.invert(m.touch0[0]);else if(m.end(),m.taps===2&&(O=Lt(O,this),Math.hypot(f[0]-O[0],f[1]-O[1])<P)){var C=et(this).on("dblclick.zoom");C&&C.apply(this,arguments)}}}return N.wheelDelta=function(y){return arguments.length?(i=typeof y=="function"?y:yn(+y),N):i},N.filter=function(y){return arguments.length?(e=typeof y=="function"?y:yn(!!y),N):e},N.touchable=function(y){return arguments.length?(r=typeof y=="function"?y:yn(!!y),N):r},N.extent=function(y){return arguments.length?(t=typeof y=="function"?y:yn([[+y[0][0],+y[0][1]],[+y[1][0],+y[1][1]]]),N):t},N.scaleExtent=function(y){return arguments.length?(o[0]=+y[0],o[1]=+y[1],N):[o[0],o[1]]},N.translateExtent=function(y){return arguments.length?(s[0][0]=+y[0][0],s[1][0]=+y[1][0],s[0][1]=+y[0][1],s[1][1]=+y[1][1],N):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},N.constrain=function(y){return arguments.length?(n=y,N):n},N.duration=function(y){return arguments.length?(l=+y,N):l},N.interpolate=function(y){return arguments.length?(a=y,N):a},N.on=function(){var y=u.on.apply(u,arguments);return y===u?N:y},N.clickDistance=function(y){return arguments.length?(b=(y=+y)*y,N):Math.sqrt(b)},N.tapDistance=function(y){return arguments.length?(P=+y,N):P},N}const l0=fr({length:5});class tn{systems=[];lanes=[];systemMap=new Map;laneMap=new Map;neighborMap=new Map;addSystem(t){this.systems.push(t),this.systemMap.set(t.id,t)}addLane(t,n){const i=[t.id,n.id].sort((s,l)=>s.localeCompare(l)).join("-");if(this.lanes.findIndex(s=>s.id===i)!==-1)return;const o={id:i,fromId:t.id,toId:n.id};this.lanes.push(o),this.laneMap.set(i,o)}getNextNodeIndex(){return this.systems.length}buildNeighborMap(){const t=new Map;this.lanes.forEach(n=>{t.has(n.fromId)||t.set(n.fromId,[]),t.get(n.fromId)?.push(n.toId),t.has(n.toId)||t.set(n.toId,[]),t.get(n.toId)?.push(n.fromId)}),this.neighborMap=t}findClosestSystem(t){return ll(t.location,this.systems)}getAdjacentSystems(t){const n=this.systemMap.get(t);if(!n)return[];this.neighborMap||this.buildNeighborMap();const i=this.neighborMap.get(n.id);return i?i.map(r=>this.systemMap.get(r)):[]}hasLane(t,n){return this.neighborMap.get(t)?.includes(n)||!1}toJSON(){return{systems:this.systems,lanes:this.lanes}}static fromJSON(t){const n=new tn;return n.systems=t.systems??[],n.lanes=t.lanes??[],n.systemMap=new Map,n.laneMap=new Map,n.systems.forEach(i=>{n.systemMap.set(i.id,i)}),n.lanes.forEach(i=>{n.laneMap.set(i.id,i)}),n.buildNeighborMap(),n}static cuid(){return l0()}}function ll(e,t){if(t.length===0)return null;let n=null,i=1/0;return t.forEach(r=>{if(r.location[0]===e[0]&&r.location[1]===e[1])return;const o=Un(e,r.location);o<i&&(i=o,n=r)}),n}const T={tick:0,timeScale:1,running:!1,thisPlayerId:null,selectedSystems:new Set,lastSelectedSystem:null,world:new tn,players:[],playerMap:new Map,messages:[]};function a0(){T.tick=0,T.thisPlayerId=null,T.selectedSystems=new Set,T.lastSelectedSystem=null,T.timeScale=1,T.world=new tn,T.players=[],T.messages=[],T.playerMap.clear()}let u0=0;function In(e){const t=`${e} <small>${~~(T.tick/2)}${T.tick%2===1?".":""}</small>`;T.messages.push({id:u0++,message:e,tick:T.tick,html:t})}function al(){return T.playerMap.get(T.thisPlayerId)}function c0(e){T.players.push(e),T.playerMap.set(e.id,e)}function br(){return T.thisPlayerId?T.world.systems.find(e=>e.homeworld===T.thisPlayerId):null}function se(e){const t=T.thisPlayerId;if(!t)return;const n=T.playerMap.get(t);if(!n)return;n.revealedSystems.add(e.id),n.visitedSystems.add(e.id);const i=T.world.getAdjacentSystems(e.id);i&&i.forEach(r=>{n.revealedSystems.add(r.id),n.visitedSystems.add(r.id)})}function f0(e,t,n,i,r){e.moveQueue.push({ships:n,toId:t.id,fromId:e.id,playerId:i,message:r})}function si(){T.selectedSystems.clear(),T.lastSelectedSystem=null}function h0(e){T.selectedSystems.size===1&&T.selectedSystems.has(e)?si():(T.selectedSystems.clear(),T.selectedSystems.add(e),T.lastSelectedSystem=e)}function d0(e){T.selectedSystems.has(e)?p0(e):Qn(e)}function Qn(e){T.selectedSystems.has(e)||(T.selectedSystems.add(e),T.lastSelectedSystem=e)}function p0(e){T.selectedSystems.delete(e),T.lastSelectedSystem===e&&(T.lastSelectedSystem=null)}const Ee={INHABITED:"inhabited",UNINHABITED:"uninhabited"},Zn={MASS_MOVE:"MASS_MOVE",BALANCED_MOVE:"BALANCED_MOVE"},Do={territory:{aggression:.3,expansion:1,defensiveness:.5,riskTolerance:.4},rusher:{aggression:1,expansion:.4,defensiveness:.1,riskTolerance:.7},turtle:{aggression:.1,expansion:.3,defensiveness:.95,riskTolerance:.2},balanced:{aggression:.5,expansion:.5,defensiveness:.5,riskTolerance:.5}};function g0(){T.players.forEach(e=>e.bot?.makeMoves())}let m0=0;class y0{id;name;personality;botSystems;threatLevels=new Map;frontline=new Set;backline=new Set;constructor(t={}){const n=t.playerIndex??m0++;this.id=`${n}`;let i=t.personality;if(!i){const r=Object.keys(Do);i=r[n%r.length]}this.name=i,this.personality=Do[i]}makeMoves(){if(this.botSystems=T.world.systems.filter(s=>s.ownerId===this.id),this.botSystems.length===0)return;this.botSystems.forEach(s=>{s.moveQueue=[]}),this.analyzeMap();const t=this.getDefensiveMoves();this.chooseMoves(t,1-this.personality.defensiveness);const n=this.getCoordinatedAttackMoves();this.chooseMoves(n,this.personality.aggression);const i=this.getExterminateMoves();this.chooseMoves(i,this.personality.defensiveness);const r=this.getExploreMoves();this.chooseMoves(r,this.personality.expansion);const o=this.getLogisticsMoves();this.chooseMoves(o,1)}analyzeMap(){this.threatLevels.clear(),this.frontline.clear(),this.backline.clear(),this.botSystems.forEach(t=>{const n=T.world.getAdjacentSystems(t.id),i=n.filter(s=>s.ownerId&&s.ownerId!==this.id),r=n.filter(s=>!s.ownerId),o=i.reduce((s,l)=>s+l.ships,0);this.threatLevels.set(t.id,o),i.length>0||r.length>0?this.frontline.add(t.id):this.backline.add(t.id)})}getDefensiveMoves(){return this.botSystems.map(t=>{if(t.moveQueue.length>0)return[];const n=[],i=this.threatLevels.get(t.id)??0;if(i>0){const r=i*1.1;if(t.ships<r)if(t.ships<i*.5){const o=T.world.getAdjacentSystems(t.id).filter(s=>s.ownerId===this.id).sort((s,l)=>(this.threatLevels.get(s.id)||0)-(this.threatLevels.get(l.id)||0))[0];o&&n.push({message:`Retreating from ${t.id}`,from:t,to:o,units:t.ships-1,score:1e3})}else n.push({message:`Holding ${t.id}`,from:t,to:t,units:0,score:i});else t.ships<r*1.5&&n.push({message:`Defending ${t.id} from threat level ${i}`,from:t,to:t,units:0,score:i})}return n})}getCoordinatedAttackMoves(){const t=new Map;this.botSystems.forEach(i=>{if(i.moveQueue.length>0||i.ships<5)return;const r=T.world.getAdjacentSystems(i.id);r&&r.forEach(o=>{if(o.ownerId!==null&&o.ownerId!==this.id){if(T.world.getAdjacentSystems(i.id).filter(l=>l.ownerId&&l.ownerId!==this.id&&l.id!==o.id).length>0)return;t.has(o.id)||t.set(o.id,{target:o,attackers:[]}),t.get(o.id).attackers.push(i)}})});const n=[];return t.forEach(({target:i,attackers:r})=>{const s=T.world.getAdjacentSystems(i.id).filter(c=>c.ownerId===i.ownerId).length===0?1.5:1,l=r.reduce((c,f)=>{const d=this.threatLevels.get(f.id)||0,w=Math.max(0,f.ships-d*1.1);return c+Math.floor(w*(1-this.personality.defensiveness))},0),u=(i.ships+(i.homeworld?10:0))*(1.3-this.personality.riskTolerance);l>u&&r.forEach(c=>{if(c.moveQueue.length>0)return;const f=this.threatLevels.get(c.id)||0,d=Math.max(0,c.ships-f*1.1),w=Math.floor(d*(1-this.personality.defensiveness)),S=this.getBestMoveAmount(c,i,w);S>0&&n.push([{message:`Coordinated attack on ${i.id}`,from:c,to:i,units:S,score:(100+(i.homeworld?50:0))*s}])})}),n}getExterminateMoves(){return this.botSystems.map(t=>t.moveQueue.length>0?[]:t.ships<3?[]:T.world.getAdjacentSystems(t.id).flatMap(i=>{if(i.ownerId===this.id||i.ownerId===null)return[];if(t.ships>i.ships*1.5+5){const r=t.ships-2;return[{message:`Crushing weak neighbor ${i.id}`,from:t,to:i,units:r,score:40}]}return[]}))}getExploreMoves(){return this.botSystems.map(t=>t.moveQueue.length>0?[]:t.ships<2?[]:T.world.getAdjacentSystems(t.id).flatMap(i=>{if(i.ownerId!==null)return[];const r=Math.max(1,Math.floor(t.ships*.3));return[{message:`Exploring ${i.id}`,from:t,to:i,units:r,score:30}]}))}getLogisticsMoves(){return this.botSystems.map(t=>{if(t.moveQueue.length>0)return[];if(t.ships<2)return[];if(this.backline.has(t.id)){const n=T.world.getAdjacentSystems(t.id).filter(o=>this.frontline.has(o.id)&&o.ownerId===this.id);if(n.length>0){const o=n.sort((s,l)=>s.ships-l.ships)[0];return[{message:"Logistics: Frontline Support",from:t,to:o,units:t.ships-1,score:10}]}const r=T.world.getAdjacentSystems(t.id).filter(o=>o.ownerId===this.id).sort((o,s)=>o.ships-s.ships)[0];if(r&&r.ships<t.ships-2)return[{message:"Logistics: Balancing",from:t,to:r,units:Math.floor((t.ships-r.ships)/2),score:5}]}if(this.frontline.has(t.id)){const n=T.world.getAdjacentSystems(t.id).filter(i=>i.ownerId===this.id&&(this.threatLevels.get(i.id)||0)>i.ships);if(n.length>0&&(this.threatLevels.get(t.id)||0)<t.ships){const i=n[0];return[{message:"Logistics: Emergency Reinforce",from:t,to:i,units:Math.floor(t.ships/2),score:50}]}}return[]})}getBestMoveAmount(t,n,i){const r=Math.max(0,t.ships-1);let o=0;return n.ownerId===t.ownerId?o=Math.floor((t.ships-n.ships)/2):o=Math.floor(t.ships/2),o=Math.max(0,o),Math.abs(r-i)<Math.abs(o-i)?r:o}chooseMoves(t,n=1){t.length!==0&&t.forEach(i=>{if(i.length===0)return;const r=[...i].sort(w0);for(let o=0;o<r.length;o++){const s=r[o];if(Math.random()<n){f0(s.from,s.to,s.units,this.id,s.message);return}}})}}function w0(e,t){return e.score!==t.score?t.score-e.score:Math.random()-.5}function Ke(e,...t){fa&&console.log(`[DEBUG][Tick ${T.tick}] ${e}`,...t)}function xi(e,t={}){if(!ca)return;let n=1;try{n=parseInt(localStorage.getItem(e)??"0",10)+1}catch(i){console.error("Error reading event count from localStorage:",i)}if(localStorage.setItem(e,n+""),window&&window.sa_event)try{window.sa_event(e,{[e]:n,tick:T.tick,...t})}catch(i){console.error("Error tracking event:",i)}}function v0(){T.world=new tn;const e=de/(hr-1),t=-de/2,n=de/2;Ke("Generating map...");for(let s=t;s<n;s+=e){const l=Math.asin(s/(de/2))*(180/Math.PI),u=[Math.random()*360-180,l],c=x0(u),f=T.world.findClosestSystem(c);if(f){if(Un(u,f.location)<ua){s-=e;continue}T.world.addLane(c,f)}T.world.addSystem(c)}const i=[T.world.systems[T.world.systems.length-1]];for(let s=T.world.systems.length-2;s>=0;s--){const l=T.world.systems[s],a=ll(l.location,i);a&&T.world.addLane(l,a),i.push(l)}T.world.buildNeighborMap(),Ke(`Generated ${T.world.systems.length} systems and ${T.world.lanes.length} lanes.`);const r=T.world.systems.slice(0),o=Math.max(aa,Ai+dr);for(let s=0;s<o&&r.length!==0;s++){const l=Math.floor(Math.random()*r.length);if(l===0){s--;continue}const a=r[l];a.ownerId=null,a.type=Ee.INHABITED,a.ships=Jo+Math.floor(Math.random()*10),a.homeworld=null,r.splice(l,1)}}function _0(e){const t=T.world.systems.filter(r=>!r.ownerId&&r.type===Ee.INHABITED);if(t.length===0)throw"No available homeworlds to join.";const n=Math.floor(Math.random()*t.length),i=t[n];return i.ships=1,i.ownerId=i.homeworld=e,i.type=Ee.INHABITED,i}function x0(e){return{id:`${T.world.getNextNodeIndex()}`,type:Ee.UNINHABITED,location:e,ownerId:null,ships:0,homeworld:null,moveQueue:[],lastMove:null}}function S0(e,t,n){var i,r,o;n===void 0&&(n={});var s=(i=n.isImmediate)!=null&&i,l=(r=n.callback)!=null&&r,a=n.maxWait,u=Date.now(),c=[];function f(){if(a!==void 0){var w=Date.now()-u;if(w+t>=a)return a-w}return t}var d=function(){var w=[].slice.call(arguments),S=this;return new Promise(function(b,P){var N=s&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,u=Date.now(),!s){var L=e.apply(S,w);l&&l(L),c.forEach(function(k){return(0,k.resolve)(L)}),c=[]}},f()),N){var A=e.apply(S,w);return l&&l(A),b(A)}c.push({resolve:b,reject:P})})};return d.cancel=function(w){o!==void 0&&clearTimeout(o),c.forEach(function(S){return(0,S.reject)(w)}),c=[]},d}const Nr=Math.PI,Ro=Nr/2,Co=180/Nr,Bo=Nr/180,M0=Math.atan2,zo=Math.cos,E0=Math.max,I0=Math.min,Fo=Math.sin,A0=Math.sign||function(e){return e>0?1:e<0?-1:0},ul=Math.sqrt;function b0(e){return e>1?Ro:e<-1?-Ro:Math.asin(e)}function cl(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function yt(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Jn(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]}function ti(e){var t=ul(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]}function $r(e){return[M0(e[1],e[0])*Co,b0(E0(-1,I0(1,e[2])))*Co]}function Bt(e){const t=e[0]*Bo,n=e[1]*Bo,i=zo(n);return[i*zo(t),i*Fo(t),Fo(n)]}function Tr(e){return e=e.map(t=>Bt(t)),cl(e[0],yt(e[2],e[1]))}function N0(e){const t=T0(e),n=P0(t),i=k0(n,e),r=O0(n,e.length),o=$0(r,e),s=L0(n,e),{polygons:l,centers:a}=D0(s,n,e),u=R0(l),c=B0(n,e),f=C0(i,n);return{delaunay:t,edges:i,triangles:n,centers:a,neighbors:r,polygons:l,mesh:u,hull:c,urquhart:f,find:o}}function $0(e,t){function n(i,r){let o=i[0]-r[0],s=i[1]-r[1],l=i[2]-r[2];return o*o+s*s+l*l}return function(r,o,s){s===void 0&&(s=0);let l,a,u=s;const c=Bt([r,o]);do l=s,s=null,a=n(c,Bt(t[l])),e[l].forEach(f=>{let d=n(c,Bt(t[f]));if(d<a){a=d,s=f,u=f;return}});while(s!==null);return u}}function T0(e){if(e.length<2)return{};let t=0;for(;isNaN(e[t][0]+e[t][1])&&t++<e.length;);const n=qn(e[t]),i=rl().translate([0,0]).scale(1).rotate(n.invert([180,0]));e=e.map(i);const r=[];let o=1;for(let f=0,d=e.length;f<d;f++){let w=e[f][0]**2+e[f][1]**2;!isFinite(w)||w>1e32?r.push(f):w>o&&(o=w)}const s=1e6*ul(o);r.forEach(f=>e[f]=[s,0]),e.push([0,s]),e.push([-s,0]),e.push([0,-s]);const l=xr.from(e);l.projection=i;const{triangles:a,halfedges:u,inedges:c}=l;for(let f=0,d=u.length;f<d;f++)if(u[f]<0){const w=f%3==2?f-2:f+1,S=f%3==0?f+2:f-1,b=u[w],P=u[S];u[b]=P,u[P]=b,u[w]=u[S]=-1,a[f]=a[w]=a[S]=t,c[a[b]]=b%3==0?b+2:b-1,c[a[P]]=P%3==0?P+2:P-1,f+=2-f%3}else a[f]>e.length-3-1&&(a[f]=t);return l}function k0(e,t){const n=new Set;return t.length===2?[[0,1]]:(e.forEach(i=>{if(i[0]!==i[1]&&!(Tr(i.map(r=>t[r]))<0))for(let r=0,o;r<3;r++)o=(r+1)%3,n.add(es([i[r],i[o]]).join("-"))}),Array.from(n,i=>i.split("-").map(Number)))}function P0(e){const{triangles:t}=e;if(!t)return[];const n=[];for(let i=0,r=t.length/3;i<r;i++){const o=t[3*i],s=t[3*i+1],l=t[3*i+2];o!==s&&s!==l&&n.push([o,l,s])}return n}function L0(e,t){return e.map(n=>{const i=n.map(o=>t[o]).map(Bt),r=Jn(Jn(yt(i[1],i[0]),yt(i[2],i[1])),yt(i[0],i[2]));return $r(ti(r))})}function O0(e,t){const n=[];return e.forEach(i=>{for(let r=0;r<3;r++){const o=i[r],s=i[(r+1)%3];n[o]=n[o]||[],n[o].push(s)}}),e.length===0&&(t===2?(n[0]=[1],n[1]=[0]):t===1&&(n[0]=[])),n}function D0(e,t,n){const i=[],r=e.slice();if(t.length===0){if(n.length<2)return{polygons:i,centers:r};if(n.length===2){const l=Bt(n[0]),a=Bt(n[1]),u=ti(Jn(l,a)),c=ti(yt(l,a)),f=yt(u,c),d=[u,yt(u,f),yt(yt(u,f),f),yt(yt(yt(u,f),f),f)].map($r).map(s);return i.push(d),i.push(d.slice().reverse()),{polygons:i,centers:r}}}t.forEach((l,a)=>{for(let u=0;u<3;u++){const c=l[u],f=l[(u+1)%3],d=l[(u+2)%3];i[c]=i[c]||[],i[c].push([f,d,a,[c,f,d]])}});const o=i.map(l=>{const a=[l[0][2]];let u=l[0][1];for(let c=1;c<l.length;c++)for(let f=0;f<l.length;f++)if(l[f][0]==u){u=l[f][1],a.push(l[f][2]);break}if(a.length>2)return a;if(a.length==2){const c=Go(n[l[0][3][0]],n[l[0][3][1]],r[a[0]]),f=Go(n[l[0][3][2]],n[l[0][3][0]],r[a[0]]),d=s(c),w=s(f);return[a[0],w,a[1],d]}});function s(l){let a=-1;return r.slice(t.length,1/0).forEach((u,c)=>{u[0]===l[0]&&u[1]===l[1]&&(a=c+t.length)}),a<0&&(a=r.length,r.push(l)),a}return{polygons:o,centers:r}}function Go(e,t,n){e=Bt(e),t=Bt(t),n=Bt(n);const i=A0(cl(yt(t,e),n));return $r(ti(Jn(e,t)).map(r=>i*r))}function R0(e){const t=[];return e.forEach(n=>{if(!n)return;let i=n[n.length-1];for(let r of n)r>i&&t.push([i,r]),i=r}),t}function C0(e,t){return function(n){const i=new Map,r=new Map;return e.forEach((o,s)=>{const l=o.join("-");i.set(l,n[s]),r.set(l,!0)}),t.forEach(o=>{let s=0,l=-1;for(let a=0;a<3;a++){let u=es([o[a],o[(a+1)%3]]).join("-");i.get(u)>s&&(s=i.get(u),l=u)}r.set(l,!1)}),e.map(o=>r.get(o.join("-")))}}function B0(e,t){const n=new Set,i=[];e.map(l=>{if(!(Tr(l.map(a=>t[a>t.length?0:a]))>1e-12))for(let a=0;a<3;a++){let u=[l[a],l[(a+1)%3]],c=`${u[0]}-${u[1]}`;n.has(c)?n.delete(c):n.add(`${u[1]}-${u[0]}`)}});const r=new Map;let o;if(n.forEach(l=>{l=l.split("-").map(Number),r.set(l[0],l[1]),o=l[0]}),o===void 0)return i;let s=o;do{i.push(s);let l=r.get(s);r.set(s,-1),s=l}while(s>-1&&s!==o);return i}function z0(e){const t=function(n){if(t.delaunay=null,t._data=n,typeof t._data=="object"&&t._data.type==="FeatureCollection"&&(t._data=t._data.features),typeof t._data=="object"){const i=t._data.map(r=>[t._vx(r),t._vy(r),r]).filter(r=>isFinite(r[0]+r[1]));t.points=i.map(r=>[r[0],r[1]]),t.valid=i.map(r=>r[2]),t.delaunay=N0(t.points)}return t};return t._vx=function(n){if(typeof n=="object"&&"type"in n)return mo(n)[0];if(0 in n)return n[0]},t._vy=function(n){if(typeof n=="object"&&"type"in n)return mo(n)[1];if(1 in n)return n[1]},t.x=function(n){return n?(t._vx=n,t):t._vx},t.y=function(n){return n?(t._vy=n,t):t._vy},t.polygons=function(n){if(n!==void 0&&t(n),!t.delaunay)return!1;const i={type:"FeatureCollection",features:[]};return t.valid.length===0||(t.delaunay.polygons.forEach((r,o)=>i.features.push({type:"Feature",geometry:r?{type:"Polygon",coordinates:[[...r,r[0]].map(s=>t.delaunay.centers[s])]}:null,properties:{site:t.valid[o],sitecoordinates:t.points[o],neighbours:t.delaunay.neighbors[o]}})),t.valid.length===1&&i.features.push({type:"Feature",geometry:{type:"Sphere"},properties:{site:t.valid[0],sitecoordinates:t.points[0],neighbours:[]}})),i},t.triangles=function(n){return n!==void 0&&t(n),t.delaunay?{type:"FeatureCollection",features:t.delaunay.triangles.map((i,r)=>(i=i.map(o=>t.points[o]),i.center=t.delaunay.centers[r],i)).filter(i=>Tr(i)>0).map(i=>({type:"Feature",properties:{circumcenter:i.center},geometry:{type:"Polygon",coordinates:[[...i,i[0]]]}}))}:!1},t.links=function(n){if(n!==void 0&&t(n),!t.delaunay)return!1;const i=t.delaunay.edges.map(o=>Un(t.points[o[0]],t.points[o[1]])),r=t.delaunay.urquhart(i);return{type:"FeatureCollection",features:t.delaunay.edges.map((o,s)=>({type:"Feature",properties:{source:t.valid[o[0]],target:t.valid[o[1]],length:i[s],urquhart:!!r[s]},geometry:{type:"LineString",coordinates:[t.points[o[0]],t.points[o[1]]]}}))}},t.mesh=function(n){return n!==void 0&&t(n),t.delaunay?{type:"MultiLineString",coordinates:t.delaunay.edges.map(i=>[t.points[i[0]],t.points[i[1]]])}:!1},t.cellMesh=function(n){if(n!==void 0&&t(n),!t.delaunay)return!1;const{centers:i,polygons:r}=t.delaunay,o=[];for(const s of r)if(s)for(let l=s.length,a=s[l-1],u=s[0],c=0;c<l;a=u,u=s[++c])u>a&&o.push([i[a],i[u]]);return{type:"MultiLineString",coordinates:o}},t._found=void 0,t.find=function(n,i,r){if(t._found=t.delaunay.find(n,i,t._found),!r||Un([n,i],t.points[t._found])<r)return t._found},t.hull=function(n){n!==void 0&&t(n);const i=t.delaunay.hull,r=t.points;return i.length===0?null:{type:"Polygon",coordinates:[[...i.map(o=>r[o]),r[i[0]]]]}},e?t(e):t}const fl=Math.acos,F0=Math.asin,Ho=Math.atan2,ie=Math.cos,qo=Math.hypot,or=Math.max,sr=Math.min,hl=Math.PI,re=Math.sin,ze=hl/180,Si=180/hl;class bt{static fromCartesian([t,n,i]){return[0,i,-n,t]}static fromAngles([t,n,i]){t*=ze/2,n*=ze/2,i=(i||0)*ze/2;const r=re(t),o=ie(t),s=re(n),l=ie(n),a=re(i),u=ie(i);return[o*l*u+r*s*a,r*l*u-o*s*a,o*s*u+r*l*a,o*l*a-r*s*u]}static toAngles([t,n,i,r]){return[Ho(2*(t*n+i*r),1-2*(n*n+i*i))*Si,F0(or(-1,sr(1,2*(t*i-r*n))))*Si,Ho(2*(t*r+n*i),1-2*(i*i+r*r))*Si]}static interpolateAngles(t,n){const i=bt.interpolate(bt.fromAngles(t),bt.fromAngles(n));return r=>bt.toAngles(i(r))}static interpolateLinear([t,n,i,r],[o,s,l,a]){o-=t,s-=n,l-=i,a-=r;const u=new Array(4);return c=>{const f=qo(u[0]=t+o*c,u[1]=n+s*c,u[2]=i+l*c,u[3]=r+a*c);return u[0]/=f,u[1]/=f,u[2]/=f,u[3]/=f,u}}static interpolate([t,n,i,r],[o,s,l,a]){let u=bt.dot([t,n,i,r],[o,s,l,a]);if(u<0&&(o=-o,s=-s,l=-l,a=-a,u=-u),u>.9995)return bt.interpolateLinear([t,n,i,r],[o,s,l,a]);const c=fl(or(-1,sr(1,u))),f=new Array(4),d=qo(o-=t*u,s-=n*u,l-=i*u,a-=r*u);return o/=d,s/=d,l/=d,a/=d,w=>{const S=c*w,b=re(S),P=ie(S);return f[0]=t*P+o*b,f[1]=n*P+s*b,f[2]=i*P+l*b,f[3]=r*P+a*b,f}}static dot([t,n,i,r],[o,s,l,a]){return t*o+n*s+i*l+r*a}static multiply([t,n,i,r],[o,s,l,a]){return[t*o-n*s-i*l-r*a,t*s+n*o+i*a-r*l,t*l-n*a+i*o+r*s,t*a+n*l-i*s+r*o]}}const Et=bt.fromAngles;Et.multiply=bt.multiply;Et.rotation=bt.toAngles;Et.interpolate=bt.interpolateAngles;Et.cartesian=function(e){const t=e[0]*ze,n=e[1]*ze,i=ie(n);return[i*ie(t),i*re(t),re(n)]};Et.delta=function(e,t,n){arguments.length==2&&(n=1);const i=Math.sqrt;function r(c,f){return[c[1]*f[2]-c[2]*f[1],c[2]*f[0]-c[0]*f[2],c[0]*f[1]-c[1]*f[0]]}function o(c,f){return c[0]*f[0]+c[1]*f[1]+c[2]*f[2]}const s=r(e,t),l=i(o(s,s));if(!l)return[1,0,0,0];const a=n*fl(or(-1,sr(1,o(e,t))))/2,u=re(a);return[ie(a),s[2]/l*u,-s[1]/l*u,s[0]/l*u]};const Uo=.5,G0=.25,H0=100,q0=20,Ve={Orthographic:Zh,Stereographic:rl,Mercator:Qh,TransverseMercator:Jh};let Rt,je=Ve[na],nt=je().translate([0,0]),Zt=nt.scale(),en=Zs().projection(nt),An;const U0=z0().x(e=>e.location[0]).y(e=>e.location[1]);function X0(){const e=Object.keys(Ve),n=(e.findIndex(i=>Ve[i]===je)+1)%e.length;Y0(e[n])}function Y0(e){je=Ve[e],nt=je(),nt.translate([0,0]).rotate([0,0,0]).scale(Zt),Zt=nt.scale(),en=Zs().projection(nt)}function fe(e){const t=nt.rotate();t[0]+=e[0],t[1]+=e[1],e.length===3&&(t[2]+=e[2]),nt.rotate(t)}function K0(){et("#app").select("svg").remove(),Rt=et("#app").append("svg").attr("width","100vw").attr("height","100vh").attr("viewBox",`-${zr/2} -${de/2} ${zr} ${de}`).on("contextmenu",i=>i.preventDefault()),dl(),ml(),yl(),gl(),Rt.call(e()),Rt.call(t());function e(){return n().on("drag.render",()=>Z()).on("end.render",()=>Z())}function t(){return s0().filter(i=>i.type==="wheel").on("zoom",i=>{if(i.transform.k>Uo){const r=Zt*i.transform.k;nt.scale(r),pl()}else i.transform.k=Uo})}function n(){let i,r,o,s,l;function a(d,w){const S=ju(d,w);if(S.length!==l&&(l=S.length,l>1&&(s=Math.atan2(S[1][1]-S[0][1],S[1][0]-S[0][0])),u.apply(w,[d,w])),l>1){const b=Fr(S,A=>A[0]),P=Fr(S,A=>A[1]),N=Math.atan2(S[1][1]-S[0][1],S[1][0]-S[0][0]);return[b,P,N]}return S[0]}function u({x:d,y:w}){const S=f([d,w]);i=Et.cartesian(nt.invert(S)),o=nt.rotate(),r=Et(o)}function c(d){const w=f([d.x,d.y]),S=Et.cartesian(nt.rotate(o).invert(w)),b=Et.delta(i,S);let P=Et.multiply(r,b);const N=a(d,this);if(N[2]){const A=(N[2]-s)/2,L=-Math.sin(A),k=Math.sign(Math.cos(A));P=Et.multiply([Math.sqrt(1-L*L),0,0,k*L],P)}nt.rotate(Et.rotation(P)),b[0]<.7&&u.apply(this,[d,this])}function f(d){const w=parseInt(Rt.style("width")),S=parseInt(Rt.style("height"));return[d[0]-w/2,d[1]-S/2]}return ec().filter(d=>d.button===1||d.touches).on("start",u).on("drag",c)}}function V0(){const e=$h(),t=br();if(t){if(!An){const n=qn([0,90+t.location[1],0]),i=qn([t.location[0],0,0]);An={type:"FeatureCollection",features:e.lines().map(r=>({type:"Feature",geometry:{type:"LineString",coordinates:r.coordinates.map(o=>i(n(o)))}}))}}return An}return e()}function dl(){const e=V0();Rt.selectAll("g#graticule").data([e]).join(n=>n.append("g").attr("id","graticule")).selectAll("path").data([e]).join(n=>n.append("path").attr("class","graticule").style("fill","none").style("stroke","#333")).attr("d",en)}function Xo(e){const t=nt.scale()*e;t<Zt*G0||t>Zt*H0||(nt.scale(t),Z())}function lr(){const e=br();if(!e)return;An=null;const t=e.location;je===Ve.Orthographic?ar([t[0],t[1]-45]):ar(t),nt.scale(Zt)}function j0(e){const t=T.world.systemMap.get(e);t&&(ar(t.location),nt.scale(Zt))}function ar(e){nt.rotate([-e[0],-e[1],0]),Z()}function pl(){Rt&&(dl(),ml(),gl(),yl())}const Z=S0(pl,16);function gl(){const t=nt.scale()/Zt<1;let n=T.world.systems;const i=al();n=n.filter(s=>i?i.revealedSystems.has(s.id):!1);const o=Rt.selectAll("g#systems").data([n]).join(s=>s.append("g").attr("id","systems")).classed("reduced-size",t).selectAll(".system").data(n,s=>s.id).join(s=>{const l=s.append("g").attr("class","system").attr("id",a=>`system-${a.id}`).on("click",(a,u)=>window.gameManager.onSystemClick(a,u)).on("contextmenu",(a,u)=>{a.preventDefault(),window.gameManager.onSystemClick(a,u)});return l.append("circle").attr("class","system-outline").attr("cx",0).attr("cy",0).attr("r",q0/2),l.append("text").attr("class","ship-count").attr("y",-10).attr("x",0).attr("text-anchor","start"),l.append("text").attr("class","system-icon").attr("y",0).attr("x",0).attr("text-anchor","end"),l});o.style("--owner-color",s=>T.playerMap.get(s.ownerId)?.color??null).classed("selected",s=>T.selectedSystems.has(s.id)).classed("inhabited",s=>s.type===Ee.INHABITED).classed("homeworld",s=>!!s.homeworld&&s.ownerId===s.homeworld).classed("visited",s=>i?.visitedSystems.has(s.id)??!1).classed("hidden",s=>!en({type:"Point",coordinates:s.location})).attr("transform",s=>`translate(${nt(s.location)})`),o.select(".system-icon").text(s=>s.homeworld&&s.ownerId===s.homeworld?"â¶":s.type==="inhabited"?"â¦":"â"),o.select(".ship-count").text(s=>t?"":(s.type===Ee.INHABITED?"â´":"")+(s.ships?s.ships.toString():""))}const W0=(()=>{let e=[],t=[];return()=>((!e||t!==T.world.systems)&&(t=T.world.systems,e=U0.polygons(t).features),e)})();function ml(){let e=W0();const t=al();e=e.filter(r=>{const o=r.properties?.site;return t?t.visitedSystems.has(o.id):!1}),Rt.selectAll("g#mesh").data([e]).join(r=>r.append("g").attr("id","mesh")).selectAll("path").data(e,r=>r.properties?.site.id).join(r=>r.append("path").classed("region",!0).on("click",(o,s)=>window.gameManager.onSystemClick(o,s)).on("contextmenu",(o,s)=>{o.preventDefault(),window.gameManager.onSystemClick(o,s)})).attr("d",r=>en(r)).datum(r=>r.properties.site).style("--owner-color",r=>T.playerMap.get(r.ownerId)?.color??null)}function yl(){let e=T.world.lanes;const t=T.thisPlayerId,n=T.playerMap.get(t);e=e.filter(r=>!!n&&n.revealedSystems.has(r.fromId)&&n.revealedSystems.has(r.toId)),Rt.selectAll("g#lanes").data([null]).join(r=>r.append("g").attr("id","lanes")).selectAll(".lane").data(e,r=>r.id).join(r=>r.append("path").attr("class","lane").attr("fill","none").attr("stroke-width",2).attr("stroke","orange").attr("id",(o,s)=>`lane-${s}`).on("click",(o,s)=>window.gameManager.onLaneClick(o,s)).on("contextmenu",(o,s)=>{o.preventDefault(),window.gameManager.onLaneClick(o,s)})).style("--owner-color",r=>{const o=T.world.systemMap.get(r.fromId);if(!o.ownerId)return null;const s=T.world.systemMap.get(r.toId);return!s.ownerId||o.ownerId!==s.ownerId?null:T.playerMap.get(o.ownerId)?.color??null}).attr("d",r=>{const o=T.world.systemMap.get(r.fromId),s=T.world.systemMap.get(r.toId);return en({type:"LineString",coordinates:[o.location,s.location]})})}function wl(){et("#app").selectAll("#infobox").data([null]).join(t=>t.append("div").attr("id","infobox").html("Turn: <span>0</span>")).select("span").text(`${~~(T.tick/2)}${T.tick%2===1?".":""}`)}function vl(){const e=et("#app").selectAll("#leaderbox").data([null]).join(i=>{const r=i.append("table").attr("id","leaderbox");return r.html("<thead><tr><th>Player</th><th>Systems</th><th>Ships</th></tr></thead><tbody></tbody>"),r}),t=T.players.sort((i,r)=>r.stats.systems-i.stats.systems||r.stats.ships-i.stats.ships);e.select("tbody").selectAll("tr").data(t).join("tr").style("--owner-color",i=>T.playerMap.get(i.id)?.color??null).attr("title",i=>i.bot?i.bot.name:"Human").classed("eliminated",i=>!i.isAlive).selectAll("td").data(i=>[i.name,i.stats.systems,i.stats.ships]).join("td").text(i=>`Â ${i}Â `)}function _l(){et("#app").selectAll("#messagebox").data([null]).join(t=>t.append("div").attr("id","messagebox")).selectAll("div").data(T.messages.slice(-5),t=>t.id).join("div").html(t=>t.html)}function Q0(){const e=document.getElementById("endDialog");document.getElementById("restartButton").addEventListener("click",()=>{e.close(),window.gameManager.connect()}),document.getElementById("helpButton").addEventListener("click",xl)}function xl(){document.getElementById("helpDialog").showModal()}function Mi(e){const t=document.getElementById("endDialog");return t.showModal(),t.querySelector("p#endMessage").textContent=e,new Promise(n=>{t.addEventListener("close",()=>n(!0)),t.addEventListener("cancel",()=>n(!1))})}function Z0(){const e=document.getElementById("startDialog"),t=document.getElementById("startButton");return e.showModal(),t.addEventListener("click",()=>{e.close(),window.gameManager.startGame()}),e}function J0(e,t,n){if(n!==0){if(n<0){if(e.ownerId!==t.ownerId)return;const i=e;e=t,t=i,n=-n}e.ships<n||(t.ownerId===e.ownerId?id(e,t,n):td(e,t,n))}}function td(e,t,n){const i=e.ownerId,r=t.ships??0;if(n>r){const o=n-r;e.ships=e.ships-n,t.ships=o,ed(i,t)}else e.ships=e.ships-n,t.ships=r-n}function ed(e,t){t.ownerId=e,t.moveQueue=[],e===T.thisPlayerId&&se(t),t.homeworld&&t.homeworld!==e&&window.gameManager.eliminatePlayer(t.homeworld,e)}function nd(e,t=null){T.world.systems.forEach(i=>{i.ownerId===e&&(i.ownerId=t,i.ships=Math.max(Math.floor((i.ships??0)/2),1),i.homeworld=null,i.moveQueue=[],t===T.thisPlayerId&&se(i)),i.homeworld===e&&(i.homeworld=null)});const n=T.playerMap.get(e);n&&(n.isAlive=!1),e===T.thisPlayerId&&window.gameManager.playerLose(t)}function id(e,t,n){e.ships<n||(e.ships-=n,t.ships+=n,t.ownerId===T.thisPlayerId&&se(t))}function rd(){T.world.systems.forEach(e=>{const t=e.moveQueue.shift();t&&window.gameManager.makeMove(t)})}function od(e){const t=T.world.systemMap.get(e.fromId);return!(t.ownerId!==e.playerId||!T.world.hasLane(e.fromId,e.toId)||t.ships<=1)}function sd(e){if(!od(e))return null;switch(e.type){case Zn.MASS_MOVE:return t(e.fromId,e.toId);case Zn.BALANCED_MOVE:return n(e.fromId,e.toId)}return null;function t(i,r){const s=T.world.systemMap.get(i).ships-1;return{message:`Move ${s} ships from ${i} to ${r}`,ships:s,toId:r,fromId:i,playerId:T.thisPlayerId}}function n(i,r){let o=T.world.systemMap.get(i),s=T.world.systemMap.get(r);const l=s.ownerId===o.ownerId?Math.floor((o.ships-s.ships)/2):Math.floor(o.ships/2);if(l<=0)if(l<0&&s.ownerId===o.ownerId){const a=o;o=s,s=a}else return null;return{message:`Move ${l} ships from ${i} to ${r}`,ships:l,toId:r,fromId:i,playerId:T.thisPlayerId}}}const gt={WAITING:"WAITING",PLAYING:"PLAYING",FINISHED:"FINISHED",PAUSED:"PAUSED"};function ld(){T.players.forEach(e=>{const t=T.world.systems.filter(r=>r.ownerId===e.id),n=t.find(r=>r.homeworld===e.id),i=t.reduce((r,o)=>r+(o.ships??0),0);e.stats={playerId:e.id,systems:t.length,ships:i,homeworld:n?.ships??0}})}function ad(){T.world.systems.forEach(e=>{e.type==="inhabited"&&e.ownerId!=null&&(e.ownerId||e.ships<Jo)&&(e.ships=(e.ships??0)+sa)})}function ud(){T.world.systems.forEach(e=>{e.ownerId!=null&&(e.ships=(e.ships??0)+la)})}function cd(){if(T.players.length===1||window.gameManager.gameState!==gt.PLAYING)return;const e=T.world.systems.filter(t=>t.homeworld&&t.ownerId===t.homeworld);if(e.length===1){const t=e[0].ownerId,n=T.playerMap.get(t);In(`Player ${n.name} has conquered The Bubble!`),window.gameManager.stopGame(),t===T.thisPlayerId?window.gameManager.playerWin():window.gameManager.playerLose(t),Z()}}function fd(){T.tick++,T.tick%ra===0&&ad(),T.tick%oa===0&&ud(),g0(),rd(),ld(),Z(),wl(),vl(),_l()}const he=5;function hd(){et("body").on("keypress.controls",null),et("body").on("keyup.controls",null),et("body").on("keyup.cheats",null),ts&&et("body").on("keyup.cheats",e=>{if(e.altKey)switch(e.preventDefault(),e.code){case"KeyC":T.world.systems.forEach(t=>{t.ownerId===T.thisPlayerId&&(t.ships*=2)}),Z();return;case"KeyR":T.world.systems.forEach(se),Z();return;case"NumpadAdd":case"Equal":T.timeScale=Math.min(16,T.timeScale*2),Ke(`Time scale increased to ${T.timeScale}x`);return;case"NumpadSubtract":case"Minus":T.timeScale=Math.max(.25,T.timeScale/2),Ke(`Time scale decreased to ${T.timeScale}x`);return}}),et("body").on("keyup.controls",e=>{switch(e.key){case"Escape":si(),Z();return;case"?":xl();return;case"x":{if(!e.ctrlKey)return;window.gameManager.quit();return}}}),et("body").on("keypress.controls",e=>{switch(e.code){case"Space":if(!("pauseToggle"in window.gameManager))return;window.gameManager.pauseToggle();return;case"Equal":case"NumpadAdd":Xo(1.2),Z();return;case"Minus":case"NumpadSubtract":Xo(.8),Z();return;case"KeyW":fe([0,he]),Z();return;case"KeyA":fe([-he,0]),Z();return;case"KeyS":fe([0,-he]),Z();return;case"KeyD":fe([he,0]),Z();return;case"KeyQ":fe([0,0,he]),Z();break;case"KeyE":fe([0,0,-he]),Z();break;case"KeyH":lr(),Z();return;case"KeyC":T.lastSelectedSystem&&(j0(T.lastSelectedSystem),Z());return;case"KeyP":X0(),lr(),Z();return}})}function dd(e){if(T.lastSelectedSystem==null)return;const t=[[T.lastSelectedSystem]],n=new Set;for(n.add(T.lastSelectedSystem);t.length>0;){const i=t.shift(),r=i[i.length-1];if(r===e){T.selectedSystems=new Set([...T.selectedSystems,...i]),T.lastSelectedSystem=e;return}for(const o of T.world.getAdjacentSystems(r))!n.has(o.id)&&o.ownerId===T.thisPlayerId&&(n.add(o.id),t.push([...i,o.id]))}}function pd(e,t){if(window.gameManager.gameState===gt.PLAYING)switch(e.button){case 0:break;case 2:{let n=T.world.systemMap.get(t.fromId),i=T.world.systemMap.get(t.toId);if(n.ownerId!==T.thisPlayerId&&i.ownerId!==T.thisPlayerId)return;if(n.ownerId!==T.thisPlayerId){const r=n;n=i,i=r}if(md(n.id,i.id),i.ownerId!==T.thisPlayerId)return;e.altKey||(!e.ctrlKey&&!e.shiftKey&&si(),Qn(n.id),i.ownerId===T.thisPlayerId&&Qn(i.id));break}}}function gd(e,t){if(window.gameManager.gameState===gt.PLAYING)switch(ts&&e.altKey&&(Ke(""+t.id,t.lastMove?.message??"none",t.lastMove?.ships??0),console.log(t)),e.button){case 0:if(t.ownerId!==T.thisPlayerId)return;e.ctrlKey||e.metaKey?d0(t.id):e.shiftKey?dd(t.id):h0(t.id);break;case-1:case 2:{const n=Array.from(T.selectedSystems);if(n.length===0)return;n.forEach(i=>{yd(i,t.id),t.ownerId===T.thisPlayerId&&(e.altKey||(!e.ctrlKey&&!e.shiftKey&&si(),Qn(t.id)))});break}}}function md(e,t){if(!T.world.hasLane(e,t))return;const n={type:Zn.BALANCED_MOVE,message:`Balanced move from ${e} to ${t}`,toId:t,fromId:e,playerId:T.thisPlayerId};window.gameManager.takeOrder(n)}function yd(e,t){if(!T.world.hasLane(e,t))return;const n={type:Zn.MASS_MOVE,toId:t,fromId:e,playerId:T.thisPlayerId,message:`Mass move from ${e} to ${t}`};window.gameManager.takeOrder(n)}class wd{gameState=gt.WAITING;runningInterval=null;constructor(){this.#t()}setupGame(){K0(),wl(),vl(),_l()}addPlayer(t,n,i,r){if(T.playerMap.has(n))return;const o={name:t,id:n,bot:i,stats:{playerId:n,systems:0,ships:0,homeworld:0},color:r,isAlive:!0,visitedSystems:new Set,revealedSystems:new Set};c0(o),i&&(i.id=o.id),document.documentElement.style.setProperty(`--player-${o.id}`,r)}setupThisPlayer(t){T.thisPlayerId=t;const n=br();se(n),lr(),T.selectedSystems.clear(),T.selectedSystems.add(n.id),T.lastSelectedSystem=n.id}startGame(){xi("starz_gamesStarted"),In("Game started.");const t=T.playerMap.get(T.thisPlayerId);t&&In(`You are Player ${t.name}.`),this.gameState=gt.PLAYING,this.runGameLoop()}stopGame(){this.gameState=gt.FINISHED,this.stopGameLoop(),T.selectedSystems.clear(),T.lastSelectedSystem=null,Z()}takeOrder(t){const n=sd(t);n&&this.makeMove(n)}makeMove(t){const n=T.world.systemMap.get(t.fromId),i=T.world.systemMap.get(t.toId);J0(n,i,t.ships),n.lastMove=t}onSystemClick(t,n){gd(t,n),Z()}onLaneClick(t,n){pd(t,n),Z()}playerWin(){return this.stopGame(),this.gameState=gt.FINISHED,T.world.systems.forEach(se),T.selectedSystems.clear(),T.lastSelectedSystem=null,xi("starz_gamesWon"),Mi("You have conquered The Bubble!")}quit(){return Mi("Quit?")}eliminatePlayer(t,n){const i=T.playerMap.get(t),r=T.playerMap.get(n),o=n===null?`Player ${i.name} has been eliminated!`:`Player ${r.name} has eliminated Player ${i.name}!`;In(o),nd(t,n)}playerLose(t){return this.stopGame(),this.gameState=gt.FINISHED,T.world.systems.forEach(se),T.lastSelectedSystem=null,T.selectedSystems.clear(),xi("starz_gamesLost",{winner:t}),Mi("You have lost your homeworld! Game Over.")}#t(){Q0(),hd()}runGameLoop(){if(this.gameState!==gt.PLAYING){this.stopGame();return}this.stopGameLoop(),fd(),cd(),this.runningInterval=setTimeout(()=>this.runGameLoop(),ia/T.timeScale)}stopGameLoop(){this.runningInterval&&(clearTimeout(this.runningInterval),this.runningInterval=null)}}const vd=fr({length:5});class _d extends wd{async connect(){this.stopGame(),this.gameState=gt.WAITING,a0(),v0();const t=Ai+dr;for(let i=1;i<=t;i++)this.playerJoin(i),_0(T.players[i-1].id);const n=T.players[0];super.setupThisPlayer(n.id),super.setupGame(),Z0(),Z()}playerJoin(t){const n=t>Ai?new y0({playerIndex:t}):void 0,i=ha[t],r=`${t}`,o=vd();super.addPlayer(r,o,n,i)}pauseToggle(){this.gameState===gt.PAUSED?(this.gameState=gt.PLAYING,this.runGameLoop()):this.gameState===gt.PLAYING&&(this.gameState=gt.PAUSED,this.stopGameLoop())}}window.onload=async()=>{const e=new _d;window.gameManager=e,await e.connect()};
